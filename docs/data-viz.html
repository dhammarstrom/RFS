<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.330">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>R for Scientific Visualization, Collaboration and Thinking - 1&nbsp; Data visualization</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./version-control.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./data-viz.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Data visualization</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R for Scientific Visualization, Collaboration and Thinking</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-viz.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Data visualization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./version-control.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Version control and collaborative scientific coding</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./writing-packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">R packages for data management and sharing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models-and-simulations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Scientific models and data simulations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#a-grammar-of-graphics---ggplot2" id="toc-a-grammar-of-graphics---ggplot2" class="nav-link active" data-scroll-target="#a-grammar-of-graphics---ggplot2"><span class="header-section-number">1.1</span> A grammar of graphics - <code>ggplot2</code></a>
  <ul class="collapse">
  <li><a href="#building-blocks-of-a-plot" id="toc-building-blocks-of-a-plot" class="nav-link" data-scroll-target="#building-blocks-of-a-plot"><span class="header-section-number">1.1.1</span> Building blocks of a plot</a></li>
  </ul></li>
  <li><a href="#before-plotting" id="toc-before-plotting" class="nav-link" data-scroll-target="#before-plotting"><span class="header-section-number">1.2</span> Before plotting</a>
  <ul class="collapse">
  <li><a href="#reading-data-into-r" id="toc-reading-data-into-r" class="nav-link" data-scroll-target="#reading-data-into-r"><span class="header-section-number">1.2.1</span> Reading data into R</a></li>
  <li><a href="#the-verbs-of-data-wrangling" id="toc-the-verbs-of-data-wrangling" class="nav-link" data-scroll-target="#the-verbs-of-data-wrangling"><span class="header-section-number">1.2.2</span> The verbs of data wrangling</a></li>
  <li><a href="#from-wide-to-long-and-back-again" id="toc-from-wide-to-long-and-back-again" class="nav-link" data-scroll-target="#from-wide-to-long-and-back-again"><span class="header-section-number">1.2.3</span> From wide to long and back again</a></li>
  <li><a href="#joining-data-sets" id="toc-joining-data-sets" class="nav-link" data-scroll-target="#joining-data-sets"><span class="header-section-number">1.2.4</span> Joining data sets</a></li>
  <li><a href="#filters-and-sorting-rows" id="toc-filters-and-sorting-rows" class="nav-link" data-scroll-target="#filters-and-sorting-rows"><span class="header-section-number">1.2.5</span> Filters and sorting rows</a></li>
  <li><a href="#summaries" id="toc-summaries" class="nav-link" data-scroll-target="#summaries"><span class="header-section-number">1.2.6</span> Summaries</a></li>
  <li><a href="#arranging-data-frames" id="toc-arranging-data-frames" class="nav-link" data-scroll-target="#arranging-data-frames"><span class="header-section-number">1.2.7</span> Arranging data frames</a></li>
  </ul></li>
  <li><a href="#ggplot-examples" id="toc-ggplot-examples" class="nav-link" data-scroll-target="#ggplot-examples"><span class="header-section-number">1.3</span> <code>ggplot</code> examples</a>
  <ul class="collapse">
  <li><a href="#labels-and-themes" id="toc-labels-and-themes" class="nav-link" data-scroll-target="#labels-and-themes"><span class="header-section-number">1.3.1</span> Labels and themes</a></li>
  </ul></li>
  <li><a href="#scientific-graphic-design" id="toc-scientific-graphic-design" class="nav-link" data-scroll-target="#scientific-graphic-design"><span class="header-section-number">1.4</span> Scientific graphic design</a>
  <ul class="collapse">
  <li><a href="#revise-and-edit" id="toc-revise-and-edit" class="nav-link" data-scroll-target="#revise-and-edit"><span class="header-section-number">1.4.1</span> Revise and edit</a></li>
  </ul></li>
  <li><a href="#edit-and-revise-in-practice" id="toc-edit-and-revise-in-practice" class="nav-link" data-scroll-target="#edit-and-revise-in-practice"><span class="header-section-number">1.5</span> Edit and revise in practice</a></li>
  <li><a href="#additional-notes-tips-and-topics" id="toc-additional-notes-tips-and-topics" class="nav-link" data-scroll-target="#additional-notes-tips-and-topics"><span class="header-section-number">1.6</span> Additional notes, tips and topics</a>
  <ul class="collapse">
  <li><a href="#labels-annotations-and-special-texts" id="toc-labels-annotations-and-special-texts" class="nav-link" data-scroll-target="#labels-annotations-and-special-texts"><span class="header-section-number">1.6.1</span> Labels, annotations and special texts</a></li>
  <li><a href="#glamorous-graphics" id="toc-glamorous-graphics" class="nav-link" data-scroll-target="#glamorous-graphics"><span class="header-section-number">1.6.2</span> Glamorous graphics</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Data visualization</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>The most apparent purpose of data visualizations in scientific contexts is to convey information not suited for text or tables but for graphical displays like comparisons between categories, relationships among variables, or trends over time <span class="citation" data-cites="gelman2002 tufte2001">(<a href="references.html#ref-gelman2002" role="doc-biblioref">Gelman, Pasarica, and Dodhia 2002</a>; <a href="references.html#ref-tufte2001" role="doc-biblioref">Tufte 2001</a>)</span>. We often think of the scientific graph as the end product of our labor. However, data visualization can be an effective tool for thinking about scientific problems and performing exploratory data analysis before preparing your manuscript. These steps will likely take up more time than polishing <em>Figure 1</em> of your upcoming paper.</p>
<div class="no-row-height column-margin column-container"><div id="ref-gelman2002" class="csl-entry" role="listitem">
Gelman, Andrew, Cristian Pasarica, and Rahul Dodhia. 2002. <span>“Let’s Practice What We Preach.”</span> <em>The American Statistician</em> 56 (2): 121–30. <a href="https://doi.org/10.1198/000313002317572790">https://doi.org/10.1198/000313002317572790</a>.
</div></div><p>Data visualization is thus a skill, like writing, with several purposes. You may write notes for yourself and write to communicate with others. Notes come in many forms, just as messages you write to others. Similarly, data visualizations can have different purposes, such as</p>
<ul>
<li><p>Checking that your data is what could be expected</p></li>
<li><p>Diagnosing statistical models</p></li>
<li><p>Exploring a relationship between many variables</p></li>
<li><p>Showing that your measurements are reliable and valid</p></li>
<li><p>Conveying the key message from your study</p></li>
</ul>
<p>Traditionally, and in many software implementations, data visualization is a matter of choosing from a menu of charts such as box plots, scatter plots, or line graphs. These can be very effective. However, you would not restrict your writing to pre-made templates. As a professional scientist in a quantitative genre, you need a toolbox for data visualizations that do not limit you. By using a <em>grammar of graphics</em> you can be more creative in designing your visualizations.</p>
<section id="a-grammar-of-graphics---ggplot2" class="level2 page-columns page-full" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="a-grammar-of-graphics---ggplot2"><span class="header-section-number">1.1</span> A grammar of graphics - <code>ggplot2</code></h2>
<p>Building on Wilkinsons <em>The Grammar of Graphics</em> <span class="citation" data-cites="wilkinson2005">(<a href="references.html#ref-wilkinson2005" role="doc-biblioref">Wilkinson and Wills 2005</a>)</span>, Wickham <span class="citation" data-cites="wickham2010 wickham2016">(<a href="references.html#ref-wickham2010" role="doc-biblioref">Wickham 2010</a>, <a href="references.html#ref-wickham2016" role="doc-biblioref">2016</a>)</span> implemented a graphical grammar to R through the package <code>ggplot2</code>. The idea behind both Wickhams and Wilkinsons formalized syntax for creating data visualizations is to avoid special cases or duplicate methods and allow for creation of data visualizations based on a set of core components used in all graphics <span class="citation" data-cites="wickham2010 wilkinson2005">(<a href="references.html#ref-wickham2010" role="doc-biblioref">Wickham 2010</a>; <a href="references.html#ref-wilkinson2005" role="doc-biblioref">Wilkinson and Wills 2005</a>)</span>.</p>
<div class="no-row-height column-margin column-container"><div id="ref-wilkinson2005" class="csl-entry" role="listitem">
Wilkinson, Leland, and Graham Wills. 2005. <em>The Grammar of Graphics</em>. 2nd ed. Statistics and Computing. New York: Springer.
</div><div id="ref-wickham2016" class="csl-entry" role="listitem">
———. 2016. <em>Ggplot2 : Elegant Graphics for Data Analysis</em>. 2nd ed. Use r! Cham: Springer International Publishing : Imprint: Springer. <a href="https://doi.org/10.1007/978-3-319-24277-4">https://doi.org/10.1007/978-3-319-24277-4</a>.
</div></div><p>The grammar (in the version described by Wickham <span class="citation" data-cites="wickham2010">(<a href="references.html#ref-wickham2010" role="doc-biblioref">Wickham 2010</a>)</span>) has seven components that together creates a ggplot2 visualization (<a href="#fig-ggplotlayers">Figure&nbsp;<span>1.1</span></a>).</p>
<p>The underlying <strong>data</strong> contains the variables that are <strong>mapped to aesthetics</strong> such as coordinates, colors or shapes. Each aesthetic can be controlled through <strong>scales</strong> by assigning values to coordinates, colors, shapes etc. <strong>Geometric objects</strong> creates the visual representations of the mapping. Sometimes small multiples of the same graph are created using <strong>facets</strong> which creates subdivision of the data to be plotted in different panels. <strong>Statistical transformations</strong> creates summaries of the data, however, in its simplest form, the transformation is the identity transformation. All graphical representations are plotted in a <strong>coordinate</strong> system. <strong>Theme and annotations</strong> adds non-data layers to the plot which can include geometric shapes or text (<a href="#fig-ggplotlayers">Figure&nbsp;<span>1.1</span></a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ggplotlayers" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="data-viz_files/figure-html/fig-ggplotlayers-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1.1: Components of a ggplot2 visualization</figcaption><p></p>
</figure>
</div>
</div>
</div>
<section id="building-blocks-of-a-plot" class="level3 page-columns page-full" data-number="1.1.1">
<h3 data-number="1.1.1" class="anchored" data-anchor-id="building-blocks-of-a-plot"><span class="header-section-number">1.1.1</span> Building blocks of a plot</h3>
<p>Using a similar example as in <span class="citation" data-cites="wickham2010">(<a href="references.html#ref-wickham2010" role="doc-biblioref">Wickham 2010</a>)</span> a basic plot can be broken down into the data (see <a href="#tbl-ggplotdataexample">Table&nbsp;<span>1.1</span></a>), geometric objects, scales and coordinates and annotations. These components, that can be individually manipulated, together creates the final plot (see <a href="#fig-ggplotexample">Figure&nbsp;<span>1.2</span></a> a-d).</p>
<div class="no-row-height column-margin column-container"><div id="ref-wickham2010" class="csl-entry" role="listitem">
Wickham, Hadley. 2010. <span>“A Layered Grammar of Graphics.”</span> <em>Journal of Computational and Graphical Statistics</em> 19 (1): 3–28. <a href="https://doi.org/10.1198/jcgs.2009.07098">https://doi.org/10.1198/jcgs.2009.07098</a>.
</div></div><div class="cell">
<div class="cell-output-display">
<div id="tbl-ggplotdataexample" class="anchored">

<div id="xezmmehixy" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xezmmehixy table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xezmmehixy thead, #xezmmehixy tbody, #xezmmehixy tfoot, #xezmmehixy tr, #xezmmehixy td, #xezmmehixy th {
  border-style: none;
}

#xezmmehixy p {
  margin: 0;
  padding: 0;
}

#xezmmehixy .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xezmmehixy .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xezmmehixy .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xezmmehixy .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xezmmehixy .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xezmmehixy .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xezmmehixy .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xezmmehixy .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xezmmehixy .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xezmmehixy .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xezmmehixy .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xezmmehixy .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xezmmehixy .gt_spanner_row {
  border-bottom-style: hidden;
}

#xezmmehixy .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xezmmehixy .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xezmmehixy .gt_from_md > :first-child {
  margin-top: 0;
}

#xezmmehixy .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xezmmehixy .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xezmmehixy .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xezmmehixy .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xezmmehixy .gt_row_group_first td {
  border-top-width: 2px;
}

#xezmmehixy .gt_row_group_first th {
  border-top-width: 2px;
}

#xezmmehixy .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xezmmehixy .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xezmmehixy .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xezmmehixy .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xezmmehixy .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xezmmehixy .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xezmmehixy .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xezmmehixy .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xezmmehixy .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xezmmehixy .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xezmmehixy .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xezmmehixy .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xezmmehixy .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xezmmehixy .gt_left {
  text-align: left;
}

#xezmmehixy .gt_center {
  text-align: center;
}

#xezmmehixy .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xezmmehixy .gt_font_normal {
  font-weight: normal;
}

#xezmmehixy .gt_font_bold {
  font-weight: bold;
}

#xezmmehixy .gt_font_italic {
  font-style: italic;
}

#xezmmehixy .gt_super {
  font-size: 65%;
}

#xezmmehixy .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xezmmehixy .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xezmmehixy .gt_indent_1 {
  text-indent: 5px;
}

#xezmmehixy .gt_indent_2 {
  text-indent: 10px;
}

#xezmmehixy .gt_indent_3 {
  text-indent: 15px;
}

#xezmmehixy .gt_indent_4 {
  text-indent: 20px;
}

#xezmmehixy .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false"><caption>Table&nbsp;1.1:  <p>Example data for a ggplot</p> </caption>
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="x">x</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="y">y</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="shape">shape</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="x" class="gt_row gt_right">1.0</td>
<td headers="y" class="gt_row gt_right">3.0</td>
<td headers="shape" class="gt_row gt_left">a</td></tr>
    <tr><td headers="x" class="gt_row gt_right">2.4</td>
<td headers="y" class="gt_row gt_right">2.0</td>
<td headers="shape" class="gt_row gt_left">a</td></tr>
    <tr><td headers="x" class="gt_row gt_right">4.0</td>
<td headers="y" class="gt_row gt_right">5.0</td>
<td headers="shape" class="gt_row gt_left">b</td></tr>
    <tr><td headers="x" class="gt_row gt_right">5.2</td>
<td headers="y" class="gt_row gt_right">7.8</td>
<td headers="shape" class="gt_row gt_left">b</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ggplotexample" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="data-viz_files/figure-html/fig-ggplotexample-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1.2: Three components, geometric objects (a), coordinates and scales (b) and plot annotations (c) are constitues of the complete plot (d)</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The corresponding code to create this plot is fairly straight forward:</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-1"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-1-1"><a href="#annotated-cell-1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="annotated-cell-1-2"><a href="#annotated-cell-1-2" aria-hidden="true" tabindex="-1"></a></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-1-3" class="code-annotation-target"><a href="#annotated-cell-1-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">2.4</span>, <span class="dv">4</span>, <span class="fl">5.2</span>),</span>
<span id="annotated-cell-1-4"><a href="#annotated-cell-1-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="fl">7.8</span>), </span>
<span id="annotated-cell-1-5"><a href="#annotated-cell-1-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"b"</span>)) </span>
<span id="annotated-cell-1-6"><a href="#annotated-cell-1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-1-7"><a href="#annotated-cell-1-7" aria-hidden="true" tabindex="-1"></a></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-1-8" class="code-annotation-target"><a href="#annotated-cell-1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> df,</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-1-9" class="code-annotation-target"><a href="#annotated-cell-1-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">shape =</span> shape))  <span class="sc">+</span></span>
<span id="annotated-cell-1-10"><a href="#annotated-cell-1-10" aria-hidden="true" tabindex="-1"></a></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="annotated-cell-1-11" class="code-annotation-target"><a href="#annotated-cell-1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="annotated-cell-1-12"><a href="#annotated-cell-1-12" aria-hidden="true" tabindex="-1"></a>  </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="5" onclick="event.preventDefault();">5</a><span id="annotated-cell-1-13" class="code-annotation-target"><a href="#annotated-cell-1-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Title"</span>,</span>
<span id="annotated-cell-1-14"><a href="#annotated-cell-1-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Subtitle"</span>, </span>
<span id="annotated-cell-1-15"><a href="#annotated-cell-1-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"x-axis"</span>, </span>
<span id="annotated-cell-1-16"><a href="#annotated-cell-1-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"y-axis"</span>, </span>
<span id="annotated-cell-1-17"><a href="#annotated-cell-1-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">"legend"</span>) <span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="6" onclick="event.preventDefault();">6</a><span id="annotated-cell-1-18" class="code-annotation-target"><a href="#annotated-cell-1-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-1" data-target-annotation="1">1</dt>
<dd>
<span data-code-lines="3" data-code-cell="annotated-cell-1" data-code-annotation="1">A simple data frame is saved containing the variables we will plot</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="2">2</dt>
<dd>
<span data-code-lines="8" data-code-cell="annotated-cell-1" data-code-annotation="2">The data is explicitly called</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="3">3</dt>
<dd>
<span data-code-lines="9" data-code-cell="annotated-cell-1" data-code-annotation="3">Variables are mapped to coordinates (x and y) and shapes.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="4">4</dt>
<dd>
<span data-code-lines="11" data-code-cell="annotated-cell-1" data-code-annotation="4">Geometric objects (points) are specified with color and size determined in the function</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="5">5</dt>
<dd>
<span data-code-lines="13" data-code-cell="annotated-cell-1" data-code-annotation="5">Annotations are added to the plot through the <code>labs</code> (labels) function.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="6">6</dt>
<dd>
<span data-code-lines="18" data-code-cell="annotated-cell-1" data-code-annotation="6">A pre-built theme is used to change the default appearance of the plot.</span>
</dd>
</dl>
</div>
</div>
</section>
</section>
<section id="before-plotting" class="level2 page-columns page-full" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="before-plotting"><span class="header-section-number">1.2</span> Before plotting</h2>
<div class="page-columns page-full"><p>As we saw above, a basic visualization can be created from a data set, or a data frame which is the most common representation of data in R. A <em>tidy</em> data set has one observation per row and one variable per column. A tidy data set makes data visualization easy. However, not all data sets are friendly. In fact, some might be unfriendly because they are unhappy<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p><div class="no-row-height column-margin column-container"><li id="fn1"><p><sup>1</sup>&nbsp;The reference to happiness is a reference to <span class="citation" data-cites="wickham2014">Wickham (<a href="references.html#ref-wickham2014" role="doc-biblioref">2014</a>)</span> wherein Tolstoy’s Anna Karenina is quoted; “Happy families are all alike; every unhappy family is unhappy in its own way.” The Anna Karenina principle applies to data as non-tidy data can be non-tidy in many ways, tidy data however are tidy because they all share a common set of features.</p><div id="ref-wickham2014" class="csl-entry" role="listitem">
———. 2014. <span>“Tidy Data.”</span> <em>Journal of Statistical Software; Vol 1, Issue 10 (2014)</em>, September. <a href="https://www.jstatsoft.org/v059/i10 http://dx.doi.org/10.18637/jss.v059.i10">https://www.jstatsoft.org/v059/i10 http://dx.doi.org/10.18637/jss.v059.i10</a>.
</div></li></div></div>

<div class="no-row-height column-margin column-container"><div class="">

</div></div><p>A lot of effort goes into making data sets suitable for visualization or statistical modelling. The good news is that R is especially suited for the process of importing and wrangling data. As with other common tasks in R there are numerous ways of achieving the same goals. This is a good thing because it allows for solutions to a wide range of problems. It is also a bad thing because it makes it difficult to getting started. A collection of R packages called the <a href="https://www.tidyverse.org/">Tidyverse</a> makes the process of getting started with data wrangling easier.</p>
<p>Tidyverse can be thought of as a dialect of the R language. The dialect is designed to make it easy to write sequential operations in a way that translates thoughts and ideas to code. Sequential operations are enabled by a pipe operator. Using a pipe operator we can call functions in sequential order to do specific operations on the data. We can write such a pipe as demonstrated below with the corresponding English language descriptions to the left.</p>
<div class="columns">
<div class="column" style="width:60%;">
<p>Take the data <strong><em>then do</em></strong><br> filter the data based on <em>x</em> larger than 10 <strong><em>then do</em></strong><br> add a new calculated variable z = x + y <strong><em>then do</em></strong><br> show the output<br></p>
</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(x <span class="sc">&gt;</span> <span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">z =</span> x <span class="sc">+</span> y) <span class="sc">|&gt;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="page-columns page-full"><p>The pipe operator (<code>|&gt;</code>) takes any input and place it as the first argument in the following function<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. This is the mechanism that makes sequential operations possible. A pipe operator makes code more readable, consider the following two alternatives:</p><div class="no-row-height column-margin column-container"><li id="fn2"><p><sup>2</sup>&nbsp;A function is a basic building block of your R code. Function are designed for specific tasks and can be part of packages or created by the user. A function may take arguments such as <code>fun(&lt;ARGUMENT1&gt; = &lt;default input&gt;, &lt;ARGUMNET2&gt; = &lt;default input&gt;)</code>. Arguments can be used without explicitly naming them by putting expected input in at the right position. Orders of argument may be changed is argument names are used.</p></li></div></div>
<div class="margin-column">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-2"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-2-1" class="code-annotation-target"><a href="#annotated-cell-2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mutate</span>(<span class="fu">filter</span>(<span class="fu">select</span>(data, var1<span class="sc">:</span>var3), var1 <span class="sc">==</span> <span class="st">"xxx"</span>), <span class="at">var4 =</span> var1 <span class="sc">+</span> var2))</span>
<span id="annotated-cell-2-2"><a href="#annotated-cell-2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-2-3"><a href="#annotated-cell-2-3" aria-hidden="true" tabindex="-1"></a></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-2-4" class="code-annotation-target"><a href="#annotated-cell-2-4" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span></span>
<span id="annotated-cell-2-5"><a href="#annotated-cell-2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(var1<span class="sc">:</span>var3) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-2-6"><a href="#annotated-cell-2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(var1 <span class="sc">==</span> <span class="st">"xxx"</span>) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-2-7"><a href="#annotated-cell-2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">var4 =</span> var1 <span class="sc">+</span> var2) </span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-2" data-target-annotation="1">1</dt>
<dd>
<span data-code-lines="1" data-code-cell="annotated-cell-2" data-code-annotation="1">Alternative 1: A number of operations are performed on data, we have to read from in to out to see each step.</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="2">2</dt>
<dd>
<span data-code-lines="4" data-code-cell="annotated-cell-2" data-code-annotation="2">Alternative 2: The same steps are performed as in alternative 1, in the same order.</span>
</dd>
</dl>
</div>
</div>
<p>The pipe in alternative 2 are structured with the pipe operator making the code more readable and easier to edit. Notice that the same functions are used in both cases.</p>
<p>In R there are two main pipe operators. We have the “base R” pipe, <code>|&gt;</code>. This pipe operator is included in the base installation of R and available without loading any packages on start up. A second pipe belongs to the <code>magritter</code> package. The <code>magritter</code> pipe (<code>%&gt;%</code>) has the same basic functionality as the base pipe; the left hand input is inserted as the first argument in any right hand function.</p>
<p>Sometimes you might want to place your input somewhere else than as the first argument in a right hand function. A placeholder can be used to indicate where you would like to place your input. The base pipe differs from the <code>magritter</code> pipe in what symbol indicates a placeholder. In the example below, the function <code>some_fun()</code> expects data as the third argument. We need to use our placeholder to put the data in the correct position:</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-3"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><a class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-3-1" class="code-annotation-target"><a href="#annotated-cell-3-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span></span>
<span id="annotated-cell-3-2"><a href="#annotated-cell-3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">some_fun</span>(<span class="at">arg1 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), </span>
<span id="annotated-cell-3-3"><a href="#annotated-cell-3-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">arg2 =</span> <span class="st">"some.setting"</span>, </span>
<span id="annotated-cell-3-4"><a href="#annotated-cell-3-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">arg3 =</span> _)</span>
<span id="annotated-cell-3-5"><a href="#annotated-cell-3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-3-6"><a href="#annotated-cell-3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-3-7"><a href="#annotated-cell-3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-3-8" class="code-annotation-target"><a href="#annotated-cell-3-8" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="annotated-cell-3-9"><a href="#annotated-cell-3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">some_fun</span>(<span class="at">arg1 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), </span>
<span id="annotated-cell-3-10"><a href="#annotated-cell-3-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">arg2 =</span> <span class="st">"some.setting"</span>, </span>
<span id="annotated-cell-3-11"><a href="#annotated-cell-3-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">arg3 =</span> .)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-3" data-target-annotation="1">1</dt>
<dd>
<span data-code-lines="1" data-code-cell="annotated-cell-3" data-code-annotation="1">With the base R forward pipe operator.</span>
</dd>
<dt data-target-cell="annotated-cell-3" data-target-annotation="2">2</dt>
<dd>
<span data-code-lines="8" data-code-cell="annotated-cell-3" data-code-annotation="2">With the <code>magritter</code> forward pipe operator.</span>
</dd>
</dl>
</div>
</div>
<section id="reading-data-into-r" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="reading-data-into-r"><span class="header-section-number">1.2.1</span> Reading data into R</h3>
<p>Three packages makes reading tabular data into R easy. <code>readr</code> provides functions for reading and writing delimiter separated files, such as <code>.csv</code> or <code>.tsv</code>. <code>readxl</code> provides functions that imports data from excel files. An finally, <code>googlesheets4</code> makes it possible to read tabular data created in google sheets.</p>
<p>Data can also be loaded from packages in R since storing data is a convenient way of sharing. By including data in a package you are nudged to do some quality checks and document it. We will talk more about data packages in a later workshop.</p>
</section>
<section id="the-verbs-of-data-wrangling" class="level3" data-number="1.2.2">
<h3 data-number="1.2.2" class="anchored" data-anchor-id="the-verbs-of-data-wrangling"><span class="header-section-number">1.2.2</span> The verbs of data wrangling</h3>
<p>Once data is available in our workspace we will be able to wrangle it. In the examples below I will use a data set containing results from dual x-ray absorptiometry measurements available in the <code>exscidata</code> package. To install the <code>exscidata</code> package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(remotes)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install_github</span>(<span class="st">"dhammarstrom/exscidata"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>dplyr</code>package provides a collection of verbs to facilitate wrangling. As mentioned above, “pipeable” functions takes a data frame as its first argument. This means that we can line up functions in sequential order using a pipe operator. In all verb functions, following the data argument follows a set of arguments that specifies what we wish to do with the data. The result of the operations performed by the function are returned as a data frame.</p>
<p><code>dplyr</code> contains the following main data verbs:</p>
<ul>
<li><code>select</code></li>
<li><code>rename</code></li>
<li><code>relocate</code></li>
<li><code>mutate</code></li>
<li><code>filter</code></li>
<li><code>arrange</code></li>
<li><code>summarize</code></li>
</ul>
<p>In addition, several helper function will aid our wrangling endeavors.</p>
<p><code>dplyr</code> is loaded as part of the <code>tidyverse</code> package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="select-rename-and-relocate-variables" class="level4" data-number="1.2.2.1">
<h4 data-number="1.2.2.1" class="anchored" data-anchor-id="select-rename-and-relocate-variables"><span class="header-section-number">1.2.2.1</span> Select, rename and relocate variables</h4>
<p>Variables in a data frame may be selected and renamed. Such operation may have multiple purposes such as giving you a better overview of the data of interest or limiting what data to display in a table. Renaming can make life easier if the data set contains long variable names.</p>
<p>Below we will store a subset of the data in a new data set. But we will first have a look at what column names are available:</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-6"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><a class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-6-1" class="code-annotation-target"><a href="#annotated-cell-6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(exscidata)</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-6-2" class="code-annotation-target"><a href="#annotated-cell-6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(exscidata<span class="sc">::</span>dxadata)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-6" data-target-annotation="1">1</dt>
<dd>
<span data-code-lines="1" data-code-cell="annotated-cell-6" data-code-annotation="1">Loading the <code>exscidata</code> package</span>
</dd>
<dt data-target-cell="annotated-cell-6" data-target-annotation="2">2</dt>
<dd>
<span data-code-lines="2" data-code-cell="annotated-cell-6" data-code-annotation="2">Using <code>glimbse</code> we will get a overview of all available variables in the data set. The double <code>::</code> means that we are looking for the data set <code>dxadata</code> inside the package <code>exscidata</code>.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 80
Columns: 59
$ participant      &lt;chr&gt; "FP28", "FP40", "FP21", "FP34", "FP23", "FP26", "FP36…
$ time             &lt;chr&gt; "pre", "pre", "pre", "pre", "pre", "pre", "pre", "pre…
$ multiple         &lt;chr&gt; "L", "R", "R", "R", "R", "R", "L", "R", "R", "L", "L"…
$ single           &lt;chr&gt; "R", "L", "L", "L", "L", "L", "R", "L", "L", "R", "R"…
$ sex              &lt;chr&gt; "female", "female", "male", "female", "male", "female…
$ include          &lt;chr&gt; "incl", "incl", "incl", "incl", "incl", "excl", "incl…
$ age              &lt;dbl&gt; 24.5, 22.1, 26.8, 23.1, 24.8, 24.2, 20.5, 20.6, 37.4,…
$ height           &lt;dbl&gt; 170.0, 175.0, 184.0, 164.0, 176.5, 163.0, 158.0, 181.…
$ weight           &lt;dbl&gt; 66.5, 64.0, 85.0, 53.0, 68.5, 56.0, 60.5, 83.5, 65.0,…
$ BMD.head         &lt;dbl&gt; 2.477, 1.916, 2.306, 2.163, 2.108, 2.866, 1.849, 2.21…
$ BMD.arms         &lt;dbl&gt; 0.952, 0.815, 0.980, 0.876, 0.917, 0.973, 0.871, 0.91…
$ BMD.legs         &lt;dbl&gt; 1.430, 1.218, 1.598, 1.256, 1.402, 1.488, 1.372, 1.42…
$ BMD.body         &lt;dbl&gt; 1.044, 0.860, 1.060, 0.842, 0.925, 0.984, 0.923, 1.01…
$ BMD.ribs         &lt;dbl&gt; 0.770, 0.630, 0.765, 0.636, 0.721, 0.737, 0.648, 0.70…
$ BMD.pelvis       &lt;dbl&gt; 1.252, 1.078, 1.314, 1.044, 1.154, 1.221, 1.194, 1.32…
$ BMD.spine        &lt;dbl&gt; 1.316, 0.979, 1.293, 0.899, 1.047, 1.089, 1.006, 1.14…
$ BMD.whole        &lt;dbl&gt; 1.268, 1.082, 1.325, 1.119, 1.181, 1.350, 1.166, 1.24…
$ fat.left_arm     &lt;dbl&gt; 1168, 715, 871, 610, 788, 372, 932, 1312, 388, 668, 5…
$ fat.left_leg     &lt;dbl&gt; 4469, 4696, 3467, 3023, 3088, 2100, 4674, 5435, 1873,…
$ fat.left_body    &lt;dbl&gt; 6280, 4061, 7740, 3638, 6018, 2328, 4896, 9352, 2921,…
$ fat.left_whole   &lt;dbl&gt; 12365, 9846, 12518, 7565, 10259, 5048, 10736, 16499, …
$ fat.right_arm    &lt;dbl&gt; 1205, 769, 871, 610, 741, 374, 940, 1292, 413, 716, 5…
$ fat.right_leg    &lt;dbl&gt; 4497, 4900, 3444, 3017, 3254, 2082, 4756, 5455, 1782,…
$ fat.right_body   &lt;dbl&gt; 6082, 3923, 8172, 3602, 5699, 2144, 4705, 8674, 2640,…
$ fat.right_whole  &lt;dbl&gt; 12102, 9862, 12856, 7479, 10020, 4821, 10806, 15876, …
$ fat.arms         &lt;dbl&gt; 2373, 1484, 1742, 1220, 1529, 747, 1872, 2604, 802, 1…
$ fat.legs         &lt;dbl&gt; 8965, 9596, 6911, 6040, 6342, 4182, 9430, 10890, 3655…
$ fat.body         &lt;dbl&gt; 12362, 7984, 15912, 7239, 11717, 4472, 9601, 18026, 5…
$ fat.android      &lt;dbl&gt; 1880, 963, 2460, 1203, 1933, 527, 1663, 3183, 1240, 1…
$ fat.gynoid       &lt;dbl&gt; 5064, 5032, 4779, 3739, 4087, 2740, 5217, 6278, 2309,…
$ fat.whole        &lt;dbl&gt; 24467, 19708, 25374, 15044, 20278, 9869, 21542, 32375…
$ lean.left_arm    &lt;dbl&gt; 1987, 1931, 2884, 1753, 2652, 2425, 1913, 2266, 3066,…
$ lean.left_leg    &lt;dbl&gt; 7059, 7190, 10281, 6014, 8242, 7903, 6829, 8889, 9664…
$ lean.left_body   &lt;dbl&gt; 9516, 10693, 13847, 9736, 11387, 10573, 8954, 11482, …
$ lean.left_whole  &lt;dbl&gt; 20305, 21778, 29332, 19143, 24185, 22946, 18809, 2431…
$ lean.right_arm   &lt;dbl&gt; 2049, 2081, 2888, 1754, 2487, 2439, 1930, 2236, 3253,…
$ lean.right_leg   &lt;dbl&gt; 7104, 7506, 10200, 6009, 8685, 7841, 6950, 8923, 9198…
$ lean.right_body  &lt;dbl&gt; 9199, 10304, 14593, 9636, 10779, 9733, 8602, 10672, 1…
$ lean.right_whole &lt;dbl&gt; 19605, 21310, 29643, 18792, 23653, 21837, 19407, 2372…
$ lean.arms        &lt;dbl&gt; 4036, 4012, 5773, 3508, 5139, 4864, 3843, 4501, 6319,…
$ lean.legs        &lt;dbl&gt; 14163, 14696, 20482, 12023, 16928, 15744, 13779, 1781…
$ lean.body        &lt;dbl&gt; 18715, 20998, 28440, 19372, 22166, 20306, 17556, 2215…
$ lean.android     &lt;dbl&gt; 2669, 2782, 3810, 2455, 2904, 2656, 2297, 3094, 3344,…
$ lean.gynoid      &lt;dbl&gt; 6219, 7209, 10233, 5866, 7525, 5970, 5825, 8175, 7760…
$ lean.whole       &lt;dbl&gt; 39910, 43088, 58976, 37934, 47837, 44783, 38216, 4804…
$ BMC.left_arm     &lt;dbl&gt; 181, 138, 204, 144, 180, 173, 140, 173, 220, 226, 225…
$ BMC.left_leg     &lt;dbl&gt; 567, 508, 728, 441, 562, 574, 482, 631, 633, 630, 672…
$ BMC.left_body    &lt;dbl&gt; 622, 414, 696, 367, 526, 465, 370, 629, 473, 629, 509…
$ BMC.left_whole   &lt;dbl&gt; 1680, 1321, 1945, 1201, 1527, 1580, 1131, 1688, 1544,…
$ BMC.right_arm    &lt;dbl&gt; 198, 150, 210, 142, 176, 183, 140, 176, 224, 251, 226…
$ BMC.right_leg    &lt;dbl&gt; 574, 514, 739, 431, 552, 565, 491, 641, 622, 636, 690…
$ BMC.right_body   &lt;dbl&gt; 592, 428, 730, 351, 502, 409, 358, 582, 420, 616, 483…
$ BMC.right_whole  &lt;dbl&gt; 1582, 1288, 1958, 1130, 1451, 1466, 1229, 1668, 1478,…
$ BMC.arms         &lt;dbl&gt; 379, 288, 414, 285, 356, 357, 280, 348, 444, 478, 451…
$ BMC.legs         &lt;dbl&gt; 1142, 1022, 1467, 872, 1115, 1139, 974, 1272, 1255, 1…
$ BMC.body         &lt;dbl&gt; 1214, 842, 1426, 718, 1028, 874, 728, 1211, 893, 1245…
$ BMC.android      &lt;dbl&gt; 80, 57, 90, 44, 56, 54, 43, 77, 52, 72, 59, 60, 65, 5…
$ BMC.gynoid       &lt;dbl&gt; 314, 285, 427, 245, 299, 262, 241, 379, 335, 378, 332…
$ BMC.whole        &lt;dbl&gt; 3261, 2609, 3903, 2331, 2978, 3046, 2360, 3356, 3022,…</code></pre>
</div>
</div>
<p>The data set contains 80 rows and 59 columns. The variables in the data set are described as part of the <code>exscidata</code> package and can be seen by typing <code>?dxadata</code> in the console.</p>
<p>We will work further with lean body mass data, these are variables starting with <code>lean.</code>. In addition we need variables describing observations like <code>participant</code>, <code>time</code>, <code>multiple</code>, <code>single</code>, <code>sex</code>, <code>include</code>, <code>height</code> and <code>weight</code>. To select these variables we can try a couple of different approaches. The <code>select</code> function can select variables by name. This means that we can simply list them:</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-7"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><a class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-7-1" class="code-annotation-target"><a href="#annotated-cell-7-1" aria-hidden="true" tabindex="-1"></a>exscidata<span class="sc">::</span>dxadata <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-7-2" class="code-annotation-target"><a href="#annotated-cell-7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(participant, time, multiple, single) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-7-3" class="code-annotation-target"><a href="#annotated-cell-7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-7" data-target-annotation="1">1</dt>
<dd>
<span data-code-lines="1" data-code-cell="annotated-cell-7" data-code-annotation="1">Retrieve the data from the <code>exscidata</code> package</span>
</dd>
<dt data-target-cell="annotated-cell-7" data-target-annotation="2">2</dt>
<dd>
<span data-code-lines="2" data-code-cell="annotated-cell-7" data-code-annotation="2">select variables based on names</span>
</dd>
<dt data-target-cell="annotated-cell-7" data-target-annotation="3">3</dt>
<dd>
<span data-code-lines="3" data-code-cell="annotated-cell-7" data-code-annotation="3">Print the resulting data frame.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 80 × 4
   participant time  multiple single
   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt; 
 1 FP28        pre   L        R     
 2 FP40        pre   R        L     
 3 FP21        pre   R        L     
 4 FP34        pre   R        L     
 5 FP23        pre   R        L     
 6 FP26        pre   R        L     
 7 FP36        pre   L        R     
 8 FP38        pre   R        L     
 9 FP25        pre   R        L     
10 FP19        pre   L        R     
# ℹ 70 more rows</code></pre>
</div>
</div>
<p>The above approach means a lot of work writing all columns names in the select call. An alternative approach is to select variables based on the first and last variable in a sequence. This is possible by using the syntax <code>&lt;first column&gt;:&lt;last column&gt;</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-8"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-8-1"><a href="#annotated-cell-8-1" aria-hidden="true" tabindex="-1"></a>exscidata<span class="sc">::</span>dxadata <span class="sc">|&gt;</span>  </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-8-2" class="code-annotation-target"><a href="#annotated-cell-8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(participant<span class="sc">:</span>weight) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-8-3"><a href="#annotated-cell-8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() </span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-8" data-target-annotation="1">1</dt>
<dd>
<span data-code-lines="2" data-code-cell="annotated-cell-8" data-code-annotation="1">Selecting by the first and last column in a sequence.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 80 × 9
   participant time  multiple single sex    include   age height weight
   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1 FP28        pre   L        R      female incl     24.5   170    66.5
 2 FP40        pre   R        L      female incl     22.1   175    64  
 3 FP21        pre   R        L      male   incl     26.8   184    85  
 4 FP34        pre   R        L      female incl     23.1   164    53  
 5 FP23        pre   R        L      male   incl     24.8   176.   68.5
 6 FP26        pre   R        L      female excl     24.2   163    56  
 7 FP36        pre   L        R      female incl     20.5   158    60.5
 8 FP38        pre   R        L      female incl     20.6   181    83.5
 9 FP25        pre   R        L      male   incl     37.4   183    65  
10 FP19        pre   L        R      male   incl     22.3   178.   73.5
# ℹ 70 more rows</code></pre>
</div>
</div>
<p>We also like to have the lean body mass data included in our new data set. Since all variables containing lean body mass data starts with <code>lean.</code> we can use a helper function to select them. Two alternatives are possible:</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-9"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-9-1"><a href="#annotated-cell-9-1" aria-hidden="true" tabindex="-1"></a>exscidata<span class="sc">::</span>dxadata <span class="sc">|&gt;</span>  </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-9-2" class="code-annotation-target"><a href="#annotated-cell-9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(participant<span class="sc">:</span>weight, <span class="fu">starts_with</span>(<span class="st">"lean."</span>)) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-9-3"><a href="#annotated-cell-9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() </span>
<span id="annotated-cell-9-4"><a href="#annotated-cell-9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-9-5"><a href="#annotated-cell-9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-9-6"><a href="#annotated-cell-9-6" aria-hidden="true" tabindex="-1"></a>exscidata<span class="sc">::</span>dxadata <span class="sc">|&gt;</span>  </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-9-7" class="code-annotation-target"><a href="#annotated-cell-9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(participant<span class="sc">:</span>weight, <span class="fu">contains</span>(<span class="st">"lean."</span>)) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-9-8"><a href="#annotated-cell-9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() </span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-9" data-target-annotation="1">1</dt>
<dd>
<span data-code-lines="2" data-code-cell="annotated-cell-9" data-code-annotation="1">Using <code>starts_with</code> to select all columns that starts with <code>lean.</code></span>
</dd>
<dt data-target-cell="annotated-cell-9" data-target-annotation="2">2</dt>
<dd>
<span data-code-lines="7" data-code-cell="annotated-cell-9" data-code-annotation="2">Using <code>contains</code>to select all variables that contains <code>lean.</code></span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 80 × 23
   participant time  multiple single sex    include   age height weight
   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1 FP28        pre   L        R      female incl     24.5   170    66.5
 2 FP40        pre   R        L      female incl     22.1   175    64  
 3 FP21        pre   R        L      male   incl     26.8   184    85  
 4 FP34        pre   R        L      female incl     23.1   164    53  
 5 FP23        pre   R        L      male   incl     24.8   176.   68.5
 6 FP26        pre   R        L      female excl     24.2   163    56  
 7 FP36        pre   L        R      female incl     20.5   158    60.5
 8 FP38        pre   R        L      female incl     20.6   181    83.5
 9 FP25        pre   R        L      male   incl     37.4   183    65  
10 FP19        pre   L        R      male   incl     22.3   178.   73.5
# ℹ 70 more rows
# ℹ 14 more variables: lean.left_arm &lt;dbl&gt;, lean.left_leg &lt;dbl&gt;,
#   lean.left_body &lt;dbl&gt;, lean.left_whole &lt;dbl&gt;, lean.right_arm &lt;dbl&gt;,
#   lean.right_leg &lt;dbl&gt;, lean.right_body &lt;dbl&gt;, lean.right_whole &lt;dbl&gt;,
#   lean.arms &lt;dbl&gt;, lean.legs &lt;dbl&gt;, lean.body &lt;dbl&gt;, lean.android &lt;dbl&gt;,
#   lean.gynoid &lt;dbl&gt;, lean.whole &lt;dbl&gt;
# A tibble: 80 × 23
   participant time  multiple single sex    include   age height weight
   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1 FP28        pre   L        R      female incl     24.5   170    66.5
 2 FP40        pre   R        L      female incl     22.1   175    64  
 3 FP21        pre   R        L      male   incl     26.8   184    85  
 4 FP34        pre   R        L      female incl     23.1   164    53  
 5 FP23        pre   R        L      male   incl     24.8   176.   68.5
 6 FP26        pre   R        L      female excl     24.2   163    56  
 7 FP36        pre   L        R      female incl     20.5   158    60.5
 8 FP38        pre   R        L      female incl     20.6   181    83.5
 9 FP25        pre   R        L      male   incl     37.4   183    65  
10 FP19        pre   L        R      male   incl     22.3   178.   73.5
# ℹ 70 more rows
# ℹ 14 more variables: lean.left_arm &lt;dbl&gt;, lean.left_leg &lt;dbl&gt;,
#   lean.left_body &lt;dbl&gt;, lean.left_whole &lt;dbl&gt;, lean.right_arm &lt;dbl&gt;,
#   lean.right_leg &lt;dbl&gt;, lean.right_body &lt;dbl&gt;, lean.right_whole &lt;dbl&gt;,
#   lean.arms &lt;dbl&gt;, lean.legs &lt;dbl&gt;, lean.body &lt;dbl&gt;, lean.android &lt;dbl&gt;,
#   lean.gynoid &lt;dbl&gt;, lean.whole &lt;dbl&gt;</code></pre>
</div>
</div>
<p>There are other select helper functions such as <code>ends_with</code> and <code>matches</code> that work in a similar fashion as the above. <code>all_of</code> and <code>any_of</code> helps you select variables based on a vector of variables, <code>where</code> selects based on where a function of your choosing returns true. See <code>?select</code> for a complete list.</p>
<p>In a <code>select</code> call we can also rename variables using the syntax <code>&lt;new name&gt; = &lt;old name&gt;</code>. Let’s say we want to select and rename <code>participant</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>exscidata<span class="sc">::</span>dxadata <span class="sc">|&gt;</span>  </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">parti =</span> participant, time<span class="sc">:</span>weight, <span class="fu">starts_with</span>(<span class="st">"lean."</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 80 × 23
   parti time  multiple single sex    include   age height weight lean.left_arm
   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;         &lt;dbl&gt;
 1 FP28  pre   L        R      female incl     24.5   170    66.5          1987
 2 FP40  pre   R        L      female incl     22.1   175    64            1931
 3 FP21  pre   R        L      male   incl     26.8   184    85            2884
 4 FP34  pre   R        L      female incl     23.1   164    53            1753
 5 FP23  pre   R        L      male   incl     24.8   176.   68.5          2652
 6 FP26  pre   R        L      female excl     24.2   163    56            2425
 7 FP36  pre   L        R      female incl     20.5   158    60.5          1913
 8 FP38  pre   R        L      female incl     20.6   181    83.5          2266
 9 FP25  pre   R        L      male   incl     37.4   183    65            3066
10 FP19  pre   L        R      male   incl     22.3   178.   73.5          3760
# ℹ 70 more rows
# ℹ 13 more variables: lean.left_leg &lt;dbl&gt;, lean.left_body &lt;dbl&gt;,
#   lean.left_whole &lt;dbl&gt;, lean.right_arm &lt;dbl&gt;, lean.right_leg &lt;dbl&gt;,
#   lean.right_body &lt;dbl&gt;, lean.right_whole &lt;dbl&gt;, lean.arms &lt;dbl&gt;,
#   lean.legs &lt;dbl&gt;, lean.body &lt;dbl&gt;, lean.android &lt;dbl&gt;, lean.gynoid &lt;dbl&gt;,
#   lean.whole &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Notice how different ways of selecting variables can be combined in <code>select</code>.</p>
<p>The <code>rename</code> function makes it easy to rename variables without the need to select.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>exscidata<span class="sc">::</span>dxadata <span class="sc">|&gt;</span>  </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(participant<span class="sc">:</span>weight, <span class="fu">starts_with</span>(<span class="st">"lean."</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">parti =</span> participant) <span class="sc">|&gt;</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 80 × 23
   parti time  multiple single sex    include   age height weight lean.left_arm
   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;         &lt;dbl&gt;
 1 FP28  pre   L        R      female incl     24.5   170    66.5          1987
 2 FP40  pre   R        L      female incl     22.1   175    64            1931
 3 FP21  pre   R        L      male   incl     26.8   184    85            2884
 4 FP34  pre   R        L      female incl     23.1   164    53            1753
 5 FP23  pre   R        L      male   incl     24.8   176.   68.5          2652
 6 FP26  pre   R        L      female excl     24.2   163    56            2425
 7 FP36  pre   L        R      female incl     20.5   158    60.5          1913
 8 FP38  pre   R        L      female incl     20.6   181    83.5          2266
 9 FP25  pre   R        L      male   incl     37.4   183    65            3066
10 FP19  pre   L        R      male   incl     22.3   178.   73.5          3760
# ℹ 70 more rows
# ℹ 13 more variables: lean.left_leg &lt;dbl&gt;, lean.left_body &lt;dbl&gt;,
#   lean.left_whole &lt;dbl&gt;, lean.right_arm &lt;dbl&gt;, lean.right_leg &lt;dbl&gt;,
#   lean.right_body &lt;dbl&gt;, lean.right_whole &lt;dbl&gt;, lean.arms &lt;dbl&gt;,
#   lean.legs &lt;dbl&gt;, lean.body &lt;dbl&gt;, lean.android &lt;dbl&gt;, lean.gynoid &lt;dbl&gt;,
#   lean.whole &lt;dbl&gt;</code></pre>
</div>
</div>
<p>If we want to change the order of variables in a data set we can specify the order in a select call, or use <code>relocate</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>exscidata<span class="sc">::</span>dxadata <span class="sc">|&gt;</span>  </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(participant<span class="sc">:</span>weight, <span class="fu">starts_with</span>(<span class="st">"lean."</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(lean.whole) <span class="sc">|&gt;</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 80 × 23
   lean.whole participant time  multiple single sex    include   age height
        &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt;
 1      39910 FP28        pre   L        R      female incl     24.5   170 
 2      43088 FP40        pre   R        L      female incl     22.1   175 
 3      58976 FP21        pre   R        L      male   incl     26.8   184 
 4      37934 FP34        pre   R        L      female incl     23.1   164 
 5      47837 FP23        pre   R        L      male   incl     24.8   176.
 6      44783 FP26        pre   R        L      female excl     24.2   163 
 7      38216 FP36        pre   L        R      female incl     20.5   158 
 8      48045 FP38        pre   R        L      female incl     20.6   181 
 9      54710 FP25        pre   R        L      male   incl     37.4   183 
10      58740 FP19        pre   L        R      male   incl     22.3   178.
# ℹ 70 more rows
# ℹ 14 more variables: weight &lt;dbl&gt;, lean.left_arm &lt;dbl&gt;, lean.left_leg &lt;dbl&gt;,
#   lean.left_body &lt;dbl&gt;, lean.left_whole &lt;dbl&gt;, lean.right_arm &lt;dbl&gt;,
#   lean.right_leg &lt;dbl&gt;, lean.right_body &lt;dbl&gt;, lean.right_whole &lt;dbl&gt;,
#   lean.arms &lt;dbl&gt;, lean.legs &lt;dbl&gt;, lean.body &lt;dbl&gt;, lean.android &lt;dbl&gt;,
#   lean.gynoid &lt;dbl&gt;</code></pre>
</div>
</div>
<p><code>relocate</code> puts the selected variable as the first column in the data set. If we want to specify the location we can use the arguments <code>.before</code> or <code>.after</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>exscidata<span class="sc">::</span>dxadata <span class="sc">|&gt;</span>  </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(participant<span class="sc">:</span>weight, <span class="fu">starts_with</span>(<span class="st">"lean."</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(lean.whole, <span class="at">.after =</span> sex) <span class="sc">|&gt;</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 80 × 23
   participant time  multiple single sex    lean.whole include   age height
   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt;
 1 FP28        pre   L        R      female      39910 incl     24.5   170 
 2 FP40        pre   R        L      female      43088 incl     22.1   175 
 3 FP21        pre   R        L      male        58976 incl     26.8   184 
 4 FP34        pre   R        L      female      37934 incl     23.1   164 
 5 FP23        pre   R        L      male        47837 incl     24.8   176.
 6 FP26        pre   R        L      female      44783 excl     24.2   163 
 7 FP36        pre   L        R      female      38216 incl     20.5   158 
 8 FP38        pre   R        L      female      48045 incl     20.6   181 
 9 FP25        pre   R        L      male        54710 incl     37.4   183 
10 FP19        pre   L        R      male        58740 incl     22.3   178.
# ℹ 70 more rows
# ℹ 14 more variables: weight &lt;dbl&gt;, lean.left_arm &lt;dbl&gt;, lean.left_leg &lt;dbl&gt;,
#   lean.left_body &lt;dbl&gt;, lean.left_whole &lt;dbl&gt;, lean.right_arm &lt;dbl&gt;,
#   lean.right_leg &lt;dbl&gt;, lean.right_body &lt;dbl&gt;, lean.right_whole &lt;dbl&gt;,
#   lean.arms &lt;dbl&gt;, lean.legs &lt;dbl&gt;, lean.body &lt;dbl&gt;, lean.android &lt;dbl&gt;,
#   lean.gynoid &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="creating-new-variables" class="level4" data-number="1.2.2.2">
<h4 data-number="1.2.2.2" class="anchored" data-anchor-id="creating-new-variables"><span class="header-section-number">1.2.2.2</span> Creating new variables</h4>
<p><code>mutate</code> let’s us create new variables in a data set. These can be a function of variables already in the data set or created from our input.</p>
<p>Let’s create a variable representing the percentage of lean mass to body mass.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>exscidata<span class="sc">::</span>dxadata <span class="sc">|&gt;</span>  </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(participant<span class="sc">:</span>weight, <span class="fu">starts_with</span>(<span class="st">"lean."</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rel_lean_whole =</span> <span class="dv">100</span> <span class="sc">*</span> ((lean.whole<span class="sc">/</span><span class="dv">1000</span>) <span class="sc">/</span> weight)) <span class="sc">|&gt;</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(rel_lean_whole) <span class="sc">|&gt;</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 80 × 24
   rel_lean_whole participant time  multiple single sex    include   age height
            &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt;
 1           60.0 FP28        pre   L        R      female incl     24.5   170 
 2           67.3 FP40        pre   R        L      female incl     22.1   175 
 3           69.4 FP21        pre   R        L      male   incl     26.8   184 
 4           71.6 FP34        pre   R        L      female incl     23.1   164 
 5           69.8 FP23        pre   R        L      male   incl     24.8   176.
 6           80.0 FP26        pre   R        L      female excl     24.2   163 
 7           63.2 FP36        pre   L        R      female incl     20.5   158 
 8           57.5 FP38        pre   R        L      female incl     20.6   181 
 9           84.2 FP25        pre   R        L      male   incl     37.4   183 
10           79.9 FP19        pre   L        R      male   incl     22.3   178.
# ℹ 70 more rows
# ℹ 15 more variables: weight &lt;dbl&gt;, lean.left_arm &lt;dbl&gt;, lean.left_leg &lt;dbl&gt;,
#   lean.left_body &lt;dbl&gt;, lean.left_whole &lt;dbl&gt;, lean.right_arm &lt;dbl&gt;,
#   lean.right_leg &lt;dbl&gt;, lean.right_body &lt;dbl&gt;, lean.right_whole &lt;dbl&gt;,
#   lean.arms &lt;dbl&gt;, lean.legs &lt;dbl&gt;, lean.body &lt;dbl&gt;, lean.android &lt;dbl&gt;,
#   lean.gynoid &lt;dbl&gt;, lean.whole &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
</section>
<section id="from-wide-to-long-and-back-again" class="level3 page-columns page-full" data-number="1.2.3">
<h3 data-number="1.2.3" class="anchored" data-anchor-id="from-wide-to-long-and-back-again"><span class="header-section-number">1.2.3</span> From wide to long and back again</h3>
<p>The <code>dxadata</code> data set is not a tidy data set. It contains two variables (<code>single</code> and <code>multiple</code>) that indicates which leg has been training with low and moderate volume respectively <span class="citation" data-cites="hammarstrom2020">(<a href="references.html#ref-hammarstrom2020" role="doc-biblioref">Hammarström et al. 2020</a>)</span>. Additionally, lean mass variables could be separated based on body half (right or left). To compare training volume we need to reformat the data set. We will start by making a smaller data set that indicate training volume per leg.</p>
<div class="no-row-height column-margin column-container"></div><p>As we have already seen, <code>participant</code>, <code>single</code> and <code>multiple</code> are the variables needed to make a data set that indicates training volume per leg, per participant. We will start by selecting these columns followed by pivoting the data as the volume data is located in two variables. This essentially means that we will make the data set longer.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-15"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-15-1"><a href="#annotated-cell-15-1" aria-hidden="true" tabindex="-1"></a>exscidata<span class="sc">::</span>dxadata <span class="sc">|&gt;</span>  </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-15" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-15-2" class="code-annotation-target"><a href="#annotated-cell-15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(participant, multiple, single) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-15" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-15-3" class="code-annotation-target"><a href="#annotated-cell-15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">values_to =</span> <span class="st">"leg"</span>, <span class="at">names_to =</span> <span class="st">"volume"</span>,  <span class="at">cols =</span> multiple<span class="sc">:</span>single) <span class="sc">%&gt;%</span></span>
<span id="annotated-cell-15-4"><a href="#annotated-cell-15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-15" data-target-annotation="1">1</dt>
<dd>
<span data-code-lines="2" data-code-cell="annotated-cell-15" data-code-annotation="1">Selecting our variables of interest</span>
</dd>
<dt data-target-cell="annotated-cell-15" data-target-annotation="2">2</dt>
<dd>
<span data-code-lines="3" data-code-cell="annotated-cell-15" data-code-annotation="2">Creating a long data set based on volume data spread over two columns.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 160 × 3
   participant volume   leg  
   &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt;
 1 FP28        multiple L    
 2 FP28        single   R    
 3 FP40        multiple R    
 4 FP40        single   L    
 5 FP21        multiple R    
 6 FP21        single   L    
 7 FP34        multiple R    
 8 FP34        single   L    
 9 FP23        multiple R    
10 FP23        single   L    
# ℹ 150 more rows</code></pre>
</div>
</div>
<p>As we see we now have a long data set, but it is longer than expected. The original data contains only 41 participants. As each participant has two legs we would expect 82 observations. Above we did not remove post-intervention observations and we therefore have several duplicates. This can be taken care of by using the <code>distinct</code> function which returns unique observations across a combination of variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-16"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-16-1"><a href="#annotated-cell-16-1" aria-hidden="true" tabindex="-1"></a>participant_volume <span class="ot">&lt;-</span> exscidata<span class="sc">::</span>dxadata <span class="sc">|&gt;</span>  </span>
<span id="annotated-cell-16-2"><a href="#annotated-cell-16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(participant, multiple, single) <span class="sc">|&gt;</span> <span class="co"># </span></span>
<span id="annotated-cell-16-3"><a href="#annotated-cell-16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">values_to =</span> <span class="st">"leg"</span>, <span class="at">names_to =</span> <span class="st">"volume"</span>,  <span class="at">cols =</span> multiple<span class="sc">:</span>single) <span class="sc">%&gt;%</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-16" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-16-4" class="code-annotation-target"><a href="#annotated-cell-16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(participant, volume, leg) <span class="sc">%&gt;%</span></span>
<span id="annotated-cell-16-5"><a href="#annotated-cell-16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-16" data-target-annotation="1">1</dt>
<dd>
<span data-code-lines="4" data-code-cell="annotated-cell-16" data-code-annotation="1">Removes all duplicate combinations of <code>participant</code>, <code>volume</code> and <code>leg</code>.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 82 × 3
   participant volume   leg  
   &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt;
 1 FP28        multiple L    
 2 FP28        single   R    
 3 FP40        multiple R    
 4 FP40        single   L    
 5 FP21        multiple R    
 6 FP21        single   L    
 7 FP34        multiple R    
 8 FP34        single   L    
 9 FP23        multiple R    
10 FP23        single   L    
# ℹ 72 more rows</code></pre>
</div>
</div>
<p>We can save our smaller data set as <code>participant_volume</code></p>
<p>Next we want to create a data set of right and left leg lean mass data. We will start by selecting variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>exscidata<span class="sc">::</span>dxadata <span class="sc">|&gt;</span>  </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(participant, time, <span class="fu">starts_with</span>(<span class="st">"lean."</span>) <span class="sc">&amp;</span> <span class="fu">ends_with</span>(<span class="st">"_leg"</span>)) <span class="sc">|&gt;</span> <span class="co">#</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 80 × 4
   participant time  lean.left_leg lean.right_leg
   &lt;chr&gt;       &lt;chr&gt;         &lt;dbl&gt;          &lt;dbl&gt;
 1 FP28        pre            7059           7104
 2 FP40        pre            7190           7506
 3 FP21        pre           10281          10200
 4 FP34        pre            6014           6009
 5 FP23        pre            8242           8685
 6 FP26        pre            7903           7841
 7 FP36        pre            6829           6950
 8 FP38        pre            8889           8923
 9 FP25        pre            9664           9198
10 FP19        pre            9704           9806
# ℹ 70 more rows</code></pre>
</div>
</div>
<div class="page-columns page-full"><p>Notice how <code>&amp;</code> was used to create a conditional selection of variables. I addition to selecting time, include<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> and participant we select variables that starts with <code>lean.</code> AND ends with <code>_leg</code>.</p><div class="no-row-height column-margin column-container"><li id="fn3"><p><sup>3</sup>&nbsp;The variable <code>incl</code> is used to indicate which participants to include in a final analysis. Included participants completed a given set of training sessions.</p></li></div></div>

<div class="no-row-height column-margin column-container"><div class="">

</div></div><p>The resulting data set is wide. Two variables contains the same variable (lean mass), but one variable (leg) is lurking in two variables (<code>lean.left_leg</code> and <code>lean.right_leg</code>). Let’s make the data set long.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-18"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><a class="code-annotation-anchor" data-target-cell="annotated-cell-18" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-18-1" class="code-annotation-target"><a href="#annotated-cell-18-1" aria-hidden="true" tabindex="-1"></a>leg_leanmass <span class="ot">&lt;-</span> exscidata<span class="sc">::</span>dxadata <span class="sc">|&gt;</span></span>
<span id="annotated-cell-18-2"><a href="#annotated-cell-18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(participant, time, include, <span class="fu">starts_with</span>(<span class="st">"lean."</span>) <span class="sc">&amp;</span> <span class="fu">ends_with</span>(<span class="st">"_leg"</span>)) <span class="sc">|&gt;</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-18" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-18-3" class="code-annotation-target"><a href="#annotated-cell-18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">names_to =</span> <span class="st">"leg"</span>, <span class="at">values_to =</span> <span class="st">"lean_mass"</span>, <span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">"lean."</span>)) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-18" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-18-4" class="code-annotation-target"><a href="#annotated-cell-18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">leg =</span> <span class="fu">if_else</span>(leg <span class="sc">==</span> <span class="st">"lean.left_leg"</span>, <span class="st">"L"</span>, <span class="st">"R"</span>)) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-18-5"><a href="#annotated-cell-18-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-18-6"><a href="#annotated-cell-18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-18" data-target-annotation="1">1</dt>
<dd>
<span data-code-lines="3" data-code-cell="annotated-cell-18" data-code-annotation="1">Notice how select helpers can be used in pivot_longer.</span>
</dd>
<dt data-target-cell="annotated-cell-18" data-target-annotation="2">2</dt>
<dd>
<span data-code-lines="4" data-code-cell="annotated-cell-18" data-code-annotation="2">We use <code>mutate</code> together with <code>if_else</code> to change the leg indicator to <code>R</code> and <code>L</code></span>
</dd>
<dt data-target-cell="annotated-cell-18" data-target-annotation="3">3</dt>
<dd>
<span data-code-lines="1" data-code-cell="annotated-cell-18" data-code-annotation="3">We save the data set as <code>leg_leanmass</code></span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 160 × 5
   participant time  include leg   lean_mass
   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt;
 1 FP28        pre   incl    L          7059
 2 FP28        pre   incl    R          7104
 3 FP40        pre   incl    L          7190
 4 FP40        pre   incl    R          7506
 5 FP21        pre   incl    L         10281
 6 FP21        pre   incl    R         10200
 7 FP34        pre   incl    L          6014
 8 FP34        pre   incl    R          6009
 9 FP23        pre   incl    L          8242
10 FP23        pre   incl    R          8685
# ℹ 150 more rows</code></pre>
</div>
</div>
<p><code>pivot_longer</code> has a brother called <code>pivot_wider</code>, this functions performs the reverse operation making long data sets wide. Let’s say that we would like to calculate the paired difference of leg lean mass from pre to post, we could make a wider data set and calculate <code>post - pre</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-19"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-19-1"><a href="#annotated-cell-19-1" aria-hidden="true" tabindex="-1"></a>exscidata<span class="sc">::</span>dxadata <span class="sc">|&gt;</span>  </span>
<span id="annotated-cell-19-2"><a href="#annotated-cell-19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(participant, time, include, <span class="fu">starts_with</span>(<span class="st">"lean."</span>) <span class="sc">&amp;</span> <span class="fu">ends_with</span>(<span class="st">"_leg"</span>)) <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-19-3"><a href="#annotated-cell-19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">names_to =</span> <span class="st">"leg"</span>, <span class="at">values_to =</span> <span class="st">"lean_mass"</span>, <span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">"lean."</span>)) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-19-4"><a href="#annotated-cell-19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">leg =</span> <span class="fu">if_else</span>(leg <span class="sc">==</span> <span class="st">"lean.left_leg"</span>, <span class="st">"L"</span>, <span class="st">"R"</span>)) <span class="sc">|&gt;</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-19" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-19-5" class="code-annotation-target"><a href="#annotated-cell-19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> time, <span class="at">values_from =</span> lean_mass) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-19" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-19-6" class="code-annotation-target"><a href="#annotated-cell-19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">delta_lean_mass =</span> post <span class="sc">-</span> pre) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-19-7"><a href="#annotated-cell-19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-19" data-target-annotation="1">1</dt>
<dd>
<span data-code-lines="5" data-code-cell="annotated-cell-19" data-code-annotation="1">Pivot wider creates new columns based on names in <code>time</code> and values in <code>lean_mass</code></span>
</dd>
<dt data-target-cell="annotated-cell-19" data-target-annotation="2">2</dt>
<dd>
<span data-code-lines="6" data-code-cell="annotated-cell-19" data-code-annotation="2">The new variables is calculated as the difference between pre and post-intervention values.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 82 × 6
   participant include leg     pre  post delta_lean_mass
   &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;           &lt;dbl&gt;
 1 FP28        incl    L      7059  7273             214
 2 FP28        incl    R      7104  7227             123
 3 FP40        incl    L      7190  7192               2
 4 FP40        incl    R      7506  7437             -69
 5 FP21        incl    L     10281 10470             189
 6 FP21        incl    R     10200 10819             619
 7 FP34        incl    L      6014  6326             312
 8 FP34        incl    R      6009  6405             396
 9 FP23        incl    L      8242  8687             445
10 FP23        incl    R      8685  8480            -205
# ℹ 72 more rows</code></pre>
</div>
</div>
</section>
<section id="joining-data-sets" class="level3" data-number="1.2.4">
<h3 data-number="1.2.4" class="anchored" data-anchor-id="joining-data-sets"><span class="header-section-number">1.2.4</span> Joining data sets</h3>
<p>We have constructed two smaller data sets, one indicating which leg performed low and moderate volume and one data set containing the lean mass values for each leg, pre- and post-intervention. Next step is to join the two.</p>
<p><code>dplyr</code> contains functions for joining data frames. There are, as illustrated in <a href="#fig-join-illustration">Figure&nbsp;<span>1.3</span></a> important differences between the functions where outer joins (left, right and full) keeps all observations in <code>x</code>, <code>y</code> and both <code>x</code> and <code>y</code> respectively. <code>inner_join</code> however, drops unmatched observations from both input data frames. Unlike the others, <code>anti_join</code> function removes observations in <code>x</code> that is present in <code>y</code>.</p>
<div class="cell">
<details>
<summary>Code producing the figure</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggVennDiagram) </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2) </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Joins can be illustrated with venn diagrams.</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># We do not need information about sets etc only </span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># a way to fill three distinct areas. </span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co"># The ggVennDiagram contains a function creating </span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co"># shapes to be filled.</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>lst <span class="ot">&lt;-</span> <span class="fu">process_data</span>(<span class="fu">Venn</span>(<span class="fu">list</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="st">"1"</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="st">"1"</span>))))</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="co"># To avoid repeated code, create a function that plots</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="co"># venn diagrams with options to indicate a title and </span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="co"># specify fill colors</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>join_illustration <span class="ot">&lt;-</span> <span class="cf">function</span>(lst, </span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>                              <span class="at">fills =</span> <span class="fu">c</span>(<span class="st">"steelblue"</span>, </span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"steelblue"</span>, </span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"white"</span>), </span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>                              <span class="at">title =</span> <span class="st">"left_join(x,y)"</span>) {</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> id), <span class="at">data =</span> <span class="fu">venn_region</span>(lst), </span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Hard coded labels</span></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">300</span>, <span class="dv">700</span>), </span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">500</span>, <span class="dv">500</span>), </span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>                <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>)), </span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">8</span>, </span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"gray20"</span>) <span class="sc">+</span></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> fills) <span class="sc">+</span></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> title) <span class="sc">+</span></span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Each join gets its own fig. All figures are </span></span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a><span class="co"># ombined below with plot_grid from cowplot.</span></span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>left <span class="ot">&lt;-</span> <span class="fu">join_illustration</span>(<span class="at">lst =</span> lst, </span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>                  <span class="at">title =</span> <span class="st">"left_join(x,y)"</span>, </span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fills =</span> <span class="fu">c</span>(<span class="st">"steelblue"</span>, <span class="st">"steelblue"</span>, <span class="st">"white"</span>))</span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a>right <span class="ot">&lt;-</span> <span class="fu">join_illustration</span>(<span class="at">lst =</span> lst, </span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>                  <span class="at">title =</span> <span class="st">"right_join(x,y)"</span>, </span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fills =</span> <span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"steelblue"</span>, <span class="st">"steelblue"</span>))</span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a>inner <span class="ot">&lt;-</span> <span class="fu">join_illustration</span>(<span class="at">lst =</span> lst, </span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a>                  <span class="at">title =</span> <span class="st">"inner_join(x,y)"</span>, </span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fills =</span> <span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"steelblue"</span>, <span class="st">"white"</span>))</span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a>full <span class="ot">&lt;-</span> <span class="fu">join_illustration</span>(<span class="at">lst =</span> lst, </span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a>                  <span class="at">title =</span> <span class="st">"full_join(x,y)"</span>, </span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fills =</span> <span class="fu">c</span>(<span class="st">"steelblue"</span>, <span class="st">"steelblue"</span>, <span class="st">"steelblue"</span>))</span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a>anti <span class="ot">&lt;-</span> <span class="fu">join_illustration</span>(<span class="at">lst =</span> lst, </span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a>                  <span class="at">title =</span> <span class="st">"anti_join(x,y)"</span>, </span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fills =</span> <span class="fu">c</span>(<span class="st">"steelblue"</span>, <span class="st">"white"</span>, <span class="st">"white"</span>))</span>
<span id="cb24-65"><a href="#cb24-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-66"><a href="#cb24-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-67"><a href="#cb24-67" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(left, right, inner, full, anti, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-join-illustration" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="data-viz_files/figure-html/fig-join-illustration-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1.3: Functions for joining data sets.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Our two data sets are pretty insensitive to dropped observations since the two data sets should be complete. We will use a <code>left_join</code> to put the data set together. This will match participant and leg because these two variables exists in both data sets. If we want to join by other variables we may specify such a variable. We’ll save the joined data set as <code>leg_leanmass</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>leg_leanmass <span class="ot">&lt;-</span> leg_leanmass <span class="sc">|&gt;</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(participant_volume) <span class="sc">|&gt;</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(participant, leg)`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 160 × 6
   participant time  include leg   lean_mass volume  
   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;   
 1 FP28        pre   incl    L          7059 multiple
 2 FP28        pre   incl    R          7104 single  
 3 FP40        pre   incl    L          7190 single  
 4 FP40        pre   incl    R          7506 multiple
 5 FP21        pre   incl    L         10281 single  
 6 FP21        pre   incl    R         10200 multiple
 7 FP34        pre   incl    L          6014 single  
 8 FP34        pre   incl    R          6009 multiple
 9 FP23        pre   incl    L          8242 single  
10 FP23        pre   incl    R          8685 multiple
# ℹ 150 more rows</code></pre>
</div>
</div>
</section>
<section id="filters-and-sorting-rows" class="level3 page-columns page-full" data-number="1.2.5">
<h3 data-number="1.2.5" class="anchored" data-anchor-id="filters-and-sorting-rows"><span class="header-section-number">1.2.5</span> Filters and sorting rows</h3>
<p>We included the variable <code>include</code> in our data set, this will make it possible to get rid of observations from participants that should be part of the final analysis. We can use <code>filter</code> to perform this operation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>leg_leanmass <span class="sc">|&gt;</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(include <span class="sc">==</span> <span class="st">"incl"</span>) <span class="sc">|&gt;</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 136 × 6
   participant time  include leg   lean_mass volume  
   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;   
 1 FP28        pre   incl    L          7059 multiple
 2 FP28        pre   incl    R          7104 single  
 3 FP40        pre   incl    L          7190 single  
 4 FP40        pre   incl    R          7506 multiple
 5 FP21        pre   incl    L         10281 single  
 6 FP21        pre   incl    R         10200 multiple
 7 FP34        pre   incl    L          6014 single  
 8 FP34        pre   incl    R          6009 multiple
 9 FP23        pre   incl    L          8242 single  
10 FP23        pre   incl    R          8685 multiple
# ℹ 126 more rows</code></pre>
</div>
</div>
<div class="page-columns page-full"><p>The double equal sign can be read as “equal to” in R, a common source of confusion is that the single equal sign (<code>=</code>) is used as a assignment operator.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p><div class="no-row-height column-margin column-container"><li id="fn4"><p><sup>4</sup>&nbsp;An assignment operator is used to assign data values to objects stored in the work space. The commonly used <code>&lt;-</code> is equivalent to <code>=</code>. Note however that <code>-&gt;</code> is different from <code>=</code>.</p></li></div></div>
<div class="margin-column">

</div>
<p>The <code>filter</code> function keeps rows of a data frame where a condition that we specify returns <code>TRUE</code>. To construct testable conditions that allows for results being either <code>FALSE</code> or <code>TRUE</code> we will use one, or a combination operators, such as</p>
<table class="table">
<tbody>
<tr class="odd">
<td><code>==</code></td>
<td>→ “equal to”</td>
</tr>
<tr class="even">
<td><code>!=</code></td>
<td>→ “not equal to”</td>
</tr>
<tr class="odd">
<td><code>&gt;</code></td>
<td>→ “larger than”</td>
</tr>
<tr class="even">
<td><code>&lt;</code></td>
<td>→ “smaller than”</td>
</tr>
<tr class="odd">
<td><code>&gt;=</code>, <code>&lt;=</code></td>
<td>→ “larger/smaller or equal to”</td>
</tr>
<tr class="even">
<td><code>!</code></td>
<td>→ “NOT”</td>
</tr>
<tr class="odd">
<td><code>&amp;</code></td>
<td>→ “AND”</td>
</tr>
<tr class="even">
<td><code>|</code></td>
<td>→ “OR”</td>
</tr>
</tbody>
</table>
<div class="page-columns page-full"><p>The above are all part of a collection of logical operators.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> We may demonstrate the mechanism by which <code>filter</code> operates by creating our own vector of <code>TRUE</code>/<code>FALSE</code> values. In the code chunk below a vector (<code>INCLUDE</code>) is created based on our <code>include</code> variable. A <code>logical</code> vector is created from the statement <code>INCLUDE != "excl"</code>. We then use this vector in the filter statement.</p><div class="no-row-height column-margin column-container"><li id="fn5"><p><sup>5</sup>&nbsp;See <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/Logic.html">here</a> for a technical overview of logical operators.</p></li></div></div>
<div class="margin-column">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>INCLUDE <span class="ot">&lt;-</span> leg_leanmass <span class="sc">|&gt;</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(include)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>INCLUDE <span class="ot">&lt;-</span> INCLUDE <span class="sc">!=</span> <span class="st">"excl"</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>INCLUDE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE
 [13]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
 [25]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
 [37]  TRUE  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE  TRUE FALSE FALSE
 [49] FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
 [61]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE  TRUE
 [73]  TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
 [85]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
 [97]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
[109]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE
[121]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
[133]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
[145]  TRUE  TRUE FALSE FALSE  TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE  TRUE
[157] FALSE FALSE FALSE FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>leg_leanmass <span class="sc">|&gt;</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(INCLUDE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 136 × 6
   participant time  include leg   lean_mass volume  
   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;   
 1 FP28        pre   incl    L          7059 multiple
 2 FP28        pre   incl    R          7104 single  
 3 FP40        pre   incl    L          7190 single  
 4 FP40        pre   incl    R          7506 multiple
 5 FP21        pre   incl    L         10281 single  
 6 FP21        pre   incl    R         10200 multiple
 7 FP34        pre   incl    L          6014 single  
 8 FP34        pre   incl    R          6009 multiple
 9 FP23        pre   incl    L          8242 single  
10 FP23        pre   incl    R          8685 multiple
# ℹ 126 more rows</code></pre>
</div>
</div>
<p>In R, a vector of <code>TRUE</code>/<code>FALSE</code> (or in short form <code>T</code>/<code>F</code>) are is a special case which R will prohibit us from overwriting.</p>
<section id="grouped-filters" class="level4 page-columns page-full" data-number="1.2.5.1">
<h4 data-number="1.2.5.1" class="anchored" data-anchor-id="grouped-filters"><span class="header-section-number">1.2.5.1</span> Grouped filters</h4>
<p>Using the dplyr syntax it is easy to e.g.&nbsp;filter or mutate based on a grouping of the data set. The function <code>group_by</code> creates a grouped data set. In the context of filtering in our data set we may want to filter out observations larger than the median from two time points.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>leg_leanmass <span class="sc">|&gt;</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(time) <span class="sc">|&gt;</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(lean_mass <span class="sc">&gt;</span> <span class="fu">median</span>(lean_mass)) <span class="sc">|&gt;</span> </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 80 × 6
# Groups:   time [2]
   participant time  include leg   lean_mass volume  
   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;   
 1 FP21        pre   incl    L         10281 single  
 2 FP21        pre   incl    R         10200 multiple
 3 FP23        pre   incl    R          8685 multiple
 4 FP38        pre   incl    L          8889 single  
 5 FP38        pre   incl    R          8923 multiple
 6 FP25        pre   incl    L          9664 single  
 7 FP25        pre   incl    R          9198 multiple
 8 FP19        pre   incl    L          9704 multiple
 9 FP19        pre   incl    R          9806 single  
10 FP13        pre   incl    L         10086 multiple
# ℹ 70 more rows</code></pre>
</div>
</div>
<p>The above operation removed exactly half of the observations, as expected since we wanted observations larger than the median from both time points. We may combine this statement with filtering away <code>"excl"</code> from the <code>include</code> variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>leg_leanmass <span class="sc">|&gt;</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(time) <span class="sc">|&gt;</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(include <span class="sc">!=</span> <span class="st">"excl"</span>, lean_mass <span class="sc">&gt;</span> <span class="fu">median</span>(lean_mass)) <span class="sc">|&gt;</span> </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 68 × 6
# Groups:   time [2]
   participant time  include leg   lean_mass volume  
   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;   
 1 FP21        pre   incl    L         10281 single  
 2 FP21        pre   incl    R         10200 multiple
 3 FP23        pre   incl    R          8685 multiple
 4 FP38        pre   incl    L          8889 single  
 5 FP38        pre   incl    R          8923 multiple
 6 FP25        pre   incl    L          9664 single  
 7 FP25        pre   incl    R          9198 multiple
 8 FP19        pre   incl    L          9704 multiple
 9 FP19        pre   incl    R          9806 single  
10 FP13        pre   incl    L         10086 multiple
# ℹ 58 more rows</code></pre>
</div>
</div>
<p>Putting two conditions in a <code>filter</code> call is like explicitly using <code>&amp;</code> (AND) to combine statements. All conditions must evaluate to be <code>TRUE</code> for the row to be included in final output.</p>
<div class="page-columns page-full"><p>An alternative to grouping by the <code>group_by</code> function is to do a “per-operation grouping”<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> using the <code>.by</code> argument. This does not leave a grouping in the data frame after filtering.</p><div class="no-row-height column-margin column-container"><li id="fn6"><p><sup>6</sup>&nbsp;See <code>?dplyr_by</code></p></li></div></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>leg_leanmass <span class="sc">|&gt;</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(include <span class="sc">!=</span> <span class="st">"excl"</span>, lean_mass <span class="sc">&gt;</span> <span class="fu">median</span>(lean_mass), <span class="at">.by =</span> time) <span class="sc">|&gt;</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 68 × 6
   participant time  include leg   lean_mass volume  
   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;   
 1 FP21        pre   incl    L         10281 single  
 2 FP21        pre   incl    R         10200 multiple
 3 FP23        pre   incl    R          8685 multiple
 4 FP38        pre   incl    L          8889 single  
 5 FP38        pre   incl    R          8923 multiple
 6 FP25        pre   incl    L          9664 single  
 7 FP25        pre   incl    R          9198 multiple
 8 FP19        pre   incl    L          9704 multiple
 9 FP19        pre   incl    R          9806 single  
10 FP13        pre   incl    L         10086 multiple
# ℹ 58 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="summaries" class="level3" data-number="1.2.6">
<h3 data-number="1.2.6" class="anchored" data-anchor-id="summaries"><span class="header-section-number">1.2.6</span> Summaries</h3>
<p>We often want to reduce larger amount of data into some summaries, such as means, standard deviations, medians etc. These summaries may be calculated over any number of categorical variables representing e.g.&nbsp;groups of observations. Just like in the filtering statement above, we may work with a grouped data frame, or by using a per-operation grouping (<code>.by</code>).</p>
<p>We will calculate the median, first and third quartile, and minimum and maximum from each volume condition and time point. Below are both of the two alternatives of grouping used.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>leg_leanmass <span class="sc">|&gt;</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(include <span class="sc">!=</span> <span class="st">"excl"</span>) <span class="sc">|&gt;</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(time, volume) <span class="sc">|&gt;</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Min =</span> <span class="fu">min</span>(lean_mass), </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">q25 =</span> <span class="fu">quantile</span>(lean_mass, <span class="fl">0.25</span>), </span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">Median =</span> <span class="fu">median</span>(lean_mass), </span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">q75 =</span> <span class="fu">quantile</span>(lean_mass, <span class="fl">0.75</span>), </span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">Max =</span> <span class="fu">max</span>(lean_mass)) <span class="sc">|&gt;</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'time'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 7
# Groups:   time [2]
  time  volume     Min   q25 Median    q75   Max
  &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 post  multiple  5343 7309.  8654. 10820. 13948
2 post  single    5561 7201.  8772. 10453. 13526
3 pre   multiple  5500 7010.  8590. 10104  13166
4 pre   single    5289 7126.  8654  10125. 13166</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>leanmass_sum <span class="ot">&lt;-</span> leg_leanmass <span class="sc">|&gt;</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(include <span class="sc">!=</span> <span class="st">"excl"</span>) <span class="sc">|&gt;</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Min =</span> <span class="fu">min</span>(lean_mass), </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">q25 =</span> <span class="fu">quantile</span>(lean_mass, <span class="fl">0.25</span>), </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">Median =</span> <span class="fu">median</span>(lean_mass), </span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">q75 =</span> <span class="fu">quantile</span>(lean_mass, <span class="fl">0.75</span>), </span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">Max =</span> <span class="fu">max</span>(lean_mass), </span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">.by =</span> <span class="fu">c</span>(time, volume)) <span class="sc">|&gt;</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 7
  time  volume     Min   q25 Median    q75   Max
  &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 pre   multiple  5500 7010.  8590. 10104  13166
2 pre   single    5289 7126.  8654  10125. 13166
3 post  multiple  5343 7309.  8654. 10820. 13948
4 post  single    5561 7201.  8772. 10453. 13526</code></pre>
</div>
</div>
<p>Notice how the data frames either have a persistent grouping, or no grouping depending on how we invoked grouping. Notice also that all values are nicely displayed, this is not always the case with summarise.</p>
<p>Consider the following example</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>vals <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">4.5</span>, <span class="fl">6.7</span>, <span class="fl">4.6</span>, <span class="fl">5.1</span>, <span class="cn">NA</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(vals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
<p>The mean of a vector of values containing a missing value returns <code>NA</code>. If we where to have missing values (<code>NA</code>) in our original data we would have recievied a <code>NA</code> in results. To drop an <code>NA</code> from such a summary we need to specify <code>na.rm = TRUE</code> as part of a summary function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>vals <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">4.5</span>, <span class="fl">6.7</span>, <span class="fl">4.6</span>, <span class="fl">5.1</span>, <span class="cn">NA</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(vals, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.225</code></pre>
</div>
</div>
<p>R does not drop <code>NA</code> silently! This is a good thing as we want to get a notice when we are missing data. If we know we are missing data we need to explicitly type this in our calls. This “rule” is not always true as some functions silently drops <code>NA</code>, be aware!</p>
</section>
<section id="arranging-data-frames" class="level3" data-number="1.2.7">
<h3 data-number="1.2.7" class="anchored" data-anchor-id="arranging-data-frames"><span class="header-section-number">1.2.7</span> Arranging data frames</h3>
<p>At last we might want to arrange a data frame for ease of use, or prior to making a table etc. Arranging does not change the data frame <em>per se</em>, only how it is displayed.</p>
<p>We’ll used our summarized data frame from above and sort based on the <code>volume</code> variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>leanmass_sum <span class="sc">|&gt;</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(volume) <span class="sc">|&gt;</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 7
  time  volume     Min   q25 Median    q75   Max
  &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 pre   multiple  5500 7010.  8590. 10104  13166
2 post  multiple  5343 7309.  8654. 10820. 13948
3 pre   single    5289 7126.  8654  10125. 13166
4 post  single    5561 7201.  8772. 10453. 13526</code></pre>
</div>
</div>
<p>Any other column will also work for arranging</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>leanmass_sum <span class="sc">|&gt;</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Median) <span class="sc">|&gt;</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 7
  time  volume     Min   q25 Median    q75   Max
  &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 pre   multiple  5500 7010.  8590. 10104  13166
2 post  multiple  5343 7309.  8654. 10820. 13948
3 pre   single    5289 7126.  8654  10125. 13166
4 post  single    5561 7201.  8772. 10453. 13526</code></pre>
</div>
</div>
<p>Using a helper function (<code>desc</code>) reverses the sorting</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>leanmass_sum <span class="sc">|&gt;</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Median)) <span class="sc">|&gt;</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 7
  time  volume     Min   q25 Median    q75   Max
  &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 post  single    5561 7201.  8772. 10453. 13526
2 pre   single    5289 7126.  8654  10125. 13166
3 post  multiple  5343 7309.  8654. 10820. 13948
4 pre   multiple  5500 7010.  8590. 10104  13166</code></pre>
</div>
</div>
<p>Notice that <code>desc</code> also works for character data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>leanmass_sum <span class="sc">|&gt;</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(volume)) <span class="sc">|&gt;</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 7
  time  volume     Min   q25 Median    q75   Max
  &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 pre   single    5289 7126.  8654  10125. 13166
2 post  single    5561 7201.  8772. 10453. 13526
3 pre   multiple  5500 7010.  8590. 10104  13166
4 post  multiple  5343 7309.  8654. 10820. 13948</code></pre>
</div>
</div>
</section>
</section>
<section id="ggplot-examples" class="level2 page-columns page-full" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="ggplot-examples"><span class="header-section-number">1.3</span> <code>ggplot</code> examples</h2>
<p>As hinted above, <code>ggplot2</code> presents us with almost endless opportunities for graphical representations of our data. We will use the data we have wrangled above to better understand the <code>ggplot2</code> syntax.</p>
<div class="page-columns page-full"><p>In our summary of the lean mass data we have calculated a number of summary statistics that can be used to create a type of range-quartile-median plot not unlike the plots suggested by Tukey<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a>. We will use time as a categorical variable on the x-axis and our summary statistics displayed on the y-axis.</p><div class="no-row-height column-margin column-container"><li id="fn7"><p><sup>7</sup>&nbsp;Tukey <span class="citation" data-cites="tukey1977">(<a href="references.html#ref-tukey1977" role="doc-biblioref">1977</a>)</span> is considered to be creator of the box-plot. However, Spear may have suggested a predecessor to the box-plot in Charting statistics <span class="citation" data-cites="spear1952">(<a href="references.html#ref-spear1952" role="doc-biblioref">Spear 1952</a>)</span>.</p><div id="ref-tukey1977" class="csl-entry" role="listitem">
Tukey, John Wilder. 1977. <em>Exploratory Data Analysis</em>. Addison-Wesley Series in Behavioral Science. Reading, Mass: Addison-Wesley Pub. Co.
</div><div id="ref-spear1952" class="csl-entry" role="listitem">
Spear, M. E. 1952. <em>Charting Statistics</em>. McGraw-Hill. <a href="https://books.google.no/books?id=1vBOAAAAMAAJ">https://books.google.no/books?id=1vBOAAAAMAAJ</a>.
</div></li></div></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> leanmass_sum, <span class="fu">aes</span>(time, Median))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data-viz_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We have specified a data set, and variables for the x and y axis. This specification gives us an empty coordinate system. We need to add geometric objects to represent the data mapped to x and y coordinates. Let’s start simple</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> leanmass_sum, <span class="fu">aes</span>(time, Median)) <span class="sc">+</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data-viz_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="page-columns page-full"><p>The points now represents our median values per time point. There are a number of geometric objects, or geoms in <code>ggplot2</code>. You are also able to extend <code>ggplot2</code> by creating your own geoms, this has been done in many packages to make a specific geometric available. In <code>ggplot2</code> there are about 50 geoms available and in addition, a number of statistical transformations<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a>.</p><div class="no-row-height column-margin column-container"><li id="fn8"><p><sup>8</sup>&nbsp;See https://ggplot2.tidyverse.org/reference/ for a complete inventory.</p></li></div></div>
<div class="margin-column">

</div>
<p>In our plot in the making, instead of points we may add rectangular shapes with a bit of reorganization of the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>leanmass_sum <span class="sc">|&gt;</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Time =</span> <span class="fu">if_else</span>(time <span class="sc">==</span> <span class="st">"pre"</span>, <span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">|&gt;</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(Time, Median, <span class="at">fill =</span> volume)) <span class="sc">+</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> Time <span class="sc">-</span> <span class="fl">0.18</span>, </span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">xmax =</span> Time <span class="sc">+</span> <span class="fl">0.18</span>, </span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymin =</span> Median, </span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax =</span> q75), </span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span> </span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> Time <span class="sc">-</span> <span class="fl">0.18</span>, </span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">xmax =</span> Time <span class="sc">+</span> <span class="fl">0.18</span>, </span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymin =</span> q25, </span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax =</span> Median), </span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data-viz_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We have hacked our way to a plot showing the median as a line inside a box covering the interquartile range. Let’s add bars representing the minimum and maximum values. Note that we are using layers and we want our range bars to not over plot the boxes. We must therefore add them prior to the boxes. We will also scale the x-axis and add labels.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>leanmass_sum <span class="sc">|&gt;</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Time =</span> <span class="fu">if_else</span>(time <span class="sc">==</span> <span class="st">"pre"</span>, <span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">|&gt;</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(Time, Median, <span class="at">fill =</span> volume)) <span class="sc">+</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Min, <span class="at">ymax =</span> Max), </span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>), </span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> Time <span class="sc">-</span> <span class="fl">0.18</span>, </span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">xmax =</span> Time <span class="sc">+</span> <span class="fl">0.18</span>, </span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymin =</span> Median, </span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax =</span> q75), </span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span> </span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> Time <span class="sc">-</span> <span class="fl">0.18</span>, </span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">xmax =</span> Time <span class="sc">+</span> <span class="fl">0.18</span>, </span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymin =</span> q25, </span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax =</span> Median), </span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.75</span>, <span class="fl">2.25</span>), </span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), </span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pre"</span>, <span class="st">"post"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data-viz_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Do not bother creating the above figure! This is an example of the flexibility brought to us by using a set of simple geometric objects. There are shortcuts to the above plot that takes care of a couple of default operations. We need our data prior to being summarized with additional preparatory steps:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>leg_leanmass <span class="sc">|&gt;</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(include <span class="sc">!=</span> <span class="st">"excl"</span>) <span class="sc">|&gt;</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">factor</span>(time, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"pre"</span>, <span class="st">"post"</span>))) <span class="sc">|&gt;</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(time, lean_mass, <span class="at">fill =</span> volume)) <span class="sc">+</span> </span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>         <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data-viz_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The new plot is a box-plot showing the same statistical transformations that we made by hand using a categorical x-axis with the time-values sorted as a factor.</p>
<div class="cell">
<details>
<summary>Code producing the figure</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> leanmass_sum <span class="sc">|&gt;</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Time =</span> <span class="fu">if_else</span>(time <span class="sc">==</span> <span class="st">"pre"</span>, <span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">|&gt;</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(Time, Median, <span class="at">fill =</span> volume)) <span class="sc">+</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Min, <span class="at">ymax =</span> Max), </span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>), </span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> Time <span class="sc">-</span> <span class="fl">0.18</span>, </span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">xmax =</span> Time <span class="sc">+</span> <span class="fl">0.18</span>, </span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymin =</span> Median, </span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax =</span> q75), </span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span> </span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> Time <span class="sc">-</span> <span class="fl">0.18</span>, </span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">xmax =</span> Time <span class="sc">+</span> <span class="fl">0.18</span>, </span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymin =</span> q25, </span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax =</span> Median), </span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.75</span>, <span class="fl">2.25</span>), </span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), </span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pre"</span>, <span class="st">"post"</span>)) <span class="sc">+</span> </span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> leg_leanmass <span class="sc">|&gt;</span></span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(include <span class="sc">!=</span> <span class="st">"excl"</span>) <span class="sc">|&gt;</span></span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">factor</span>(time, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"pre"</span>, <span class="st">"post"</span>))) <span class="sc">|&gt;</span></span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-38"><a href="#cb62-38" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(time, lean_mass, <span class="at">fill =</span> volume)) <span class="sc">+</span> </span>
<span id="cb62-39"><a href="#cb62-39" aria-hidden="true" tabindex="-1"></a>         <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb62-40"><a href="#cb62-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb62-41"><a href="#cb62-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-42"><a href="#cb62-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-43"><a href="#cb62-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-44"><a href="#cb62-44" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(a, b, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>), <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="data-viz_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">A direct comparison between (a) manual statistical summaries (transformations) and built in transformations in ggplot2 (b).</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>We have seen that <code>ggplot2</code> have some built in features that makes statistical transformation, but also that a similar result can be obtained by using other “geoms” such as <code>geom_rect</code>. Again, this allows for flexible creation of data visualizations.</p>
<section id="labels-and-themes" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="labels-and-themes"><span class="header-section-number">1.3.1</span> Labels and themes</h3>
<p>So far we have used the available data to determine what is being represented in the figure. To make the figure closer to “publication ready” we would want to take control over labels, colors and shapes that so far are presented with variable names and default settings.</p>
<p>The <code>labs</code> function adds customized labels to a ggplot. All aesthetic mappings are available for labeling. We will go further with the box-plot which uses x, y and fill as aesthetics mapped to data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>leg_leanmass <span class="sc">|&gt;</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(include <span class="sc">!=</span> <span class="st">"excl"</span>) <span class="sc">|&gt;</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">factor</span>(time, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"pre"</span>, <span class="st">"post"</span>))) <span class="sc">|&gt;</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(time, lean_mass, <span class="at">fill =</span> volume)) <span class="sc">+</span> </span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>         <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time"</span>, </span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Leg lean mass (g)"</span>, </span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Volume condition"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data-viz_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Additionally, we might want to think about if we need all axis labels. The time variable is specified with <code>pre</code> and <code>post</code> and won’t need a overall axis label. Instead we might want to clean up the axis text. Since this is a data-driven element in our figure we can change it’s behavior prior to plotting. We have already changed the order of the factor, let’s add labels to each level and remove the overall <code>Time</code> label.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>leg_leanmass <span class="sc">|&gt;</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(include <span class="sc">!=</span> <span class="st">"excl"</span>) <span class="sc">|&gt;</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">factor</span>(time, </span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"pre"</span>, <span class="st">"post"</span>), </span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Pre</span><span class="sc">\n</span><span class="st">intervention"</span>, </span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Post</span><span class="sc">\n</span><span class="st">intervention"</span>))) <span class="sc">|&gt;</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(time, lean_mass, <span class="at">fill =</span> volume)) <span class="sc">+</span> </span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>         <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time"</span>, </span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Leg lean mass (g)"</span>, </span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Volume condition"</span>) <span class="sc">+</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data-viz_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Notice that we removed the “Time” label from the figure by removing it in the theme function (<code>theme(axis.title.x = element_blank())</code>; more about that later). The factor variable <code>time</code> was re-specified using the <code>factor</code> function. This function takes a character or factor variable and specifies levels (the order of factors) and optionally, labels for each level.</p>
<p>An alternative approach to changing the labels of the factor is to include labels in a call to <code>scale_x_discrete</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>leg_leanmass <span class="sc">|&gt;</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(include <span class="sc">!=</span> <span class="st">"excl"</span>) <span class="sc">|&gt;</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">factor</span>(time, </span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"pre"</span>, <span class="st">"post"</span>))) <span class="sc">|&gt;</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(time, lean_mass, <span class="at">fill =</span> volume)) <span class="sc">+</span> </span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time"</span>, </span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Leg lean mass (g)"</span>, </span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Volume condition"</span>) <span class="sc">+</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Pre</span><span class="sc">\n</span><span class="st">intervention"</span>, </span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Post</span><span class="sc">\n</span><span class="st">intervention"</span>)) <span class="sc">+</span></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data-viz_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="theming" class="level4" data-number="1.3.1.1">
<h4 data-number="1.3.1.1" class="anchored" data-anchor-id="theming"><span class="header-section-number">1.3.1.1</span> Theming</h4>
<p><code>ggplot2</code> has a very flexible system for changing parts of a figure that are not directly connected to the data (i.e.&nbsp;created from aesthetic mapping). Each element in the theme that can be controlled is listed in the help pages for <code>theme</code>, type <code>?theme</code> in your console to access it.</p>
<p>The below illustrates some of the main components we might want to consider:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>leg_leanmass <span class="sc">|&gt;</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(include <span class="sc">!=</span> <span class="st">"excl"</span>) <span class="sc">|&gt;</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">factor</span>(time, </span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"pre"</span>, <span class="st">"post"</span>))) <span class="sc">|&gt;</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(time, lean_mass, <span class="at">fill =</span> volume)) <span class="sc">+</span> </span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time"</span>, </span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Leg lean mass (g)"</span>, </span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Volume condition"</span>, </span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"The plot title"</span>, </span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"The plot subtitle"</span>, </span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"the plot caption"</span>) <span class="sc">+</span></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Pre</span><span class="sc">\n</span><span class="st">intervention"</span>, </span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Post</span><span class="sc">\n</span><span class="st">intervention"</span>)) <span class="sc">+</span></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"yellow"</span>),</span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"green"</span>), </span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"yellow"</span>, <span class="at">linewidth =</span> <span class="dv">2</span>), </span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linewidth =</span> <span class="dv">2</span>), </span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"gray50"</span>), </span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"pink"</span>, <span class="at">linewidth =</span> <span class="dv">2</span>), </span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"magenta"</span>, <span class="at">linewidth =</span> <span class="dv">2</span>), </span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"darkblue"</span>), </span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"navyblue"</span>), </span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"gray"</span>), </span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"yellow"</span>), </span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"magenta"</span>), </span>
<span id="cb66-34"><a href="#cb66-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"yellow"</span>),</span>
<span id="cb66-35"><a href="#cb66-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"lightgreen"</span>),</span>
<span id="cb66-36"><a href="#cb66-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"pink"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data-viz_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Each element of the theme can be modified with an element function. The theme element <code>axis.title</code> is a text element and must subsequently be modified with <code>element_text()</code>. This function takes a number of arguments making it possible to modify text components. Below we use our basic plot and to modify the y axis title.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>leg_leanmass <span class="sc">|&gt;</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(include <span class="sc">!=</span> <span class="st">"excl"</span>) <span class="sc">|&gt;</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">factor</span>(time, </span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"pre"</span>, <span class="st">"post"</span>))) <span class="sc">|&gt;</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(time, lean_mass, <span class="at">fill =</span> volume)) <span class="sc">+</span> </span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time"</span>, </span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Leg lean</span><span class="sc">\n</span><span class="st">mass (g)"</span>, </span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Volume condition"</span>, </span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"The plot title"</span>, </span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"The plot subtitle"</span>, </span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"the plot caption"</span>) <span class="sc">+</span></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Pre</span><span class="sc">\n</span><span class="st">intervention"</span>, </span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Post</span><span class="sc">\n</span><span class="st">intervention"</span>)) <span class="sc">+</span></span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">family =</span> <span class="st">"mono"</span>,</span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">face =</span> <span class="st">"bold"</span>,</span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a>                            </span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">size =</span> <span class="dv">20</span>,</span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">angle =</span> <span class="dv">45</span>,</span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">lineheight =</span> <span class="dv">2</span>),</span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a>        )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data-viz_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The element <code>axis.title.y</code> is similar to <code>axis.title.x</code> and if we want we could use <code>axis.title</code> to modify both for common attributes. Notice also that we have changed multiple numbers that have defaults. The <code>size</code> is the size of the text, <code>hjust</code> and <code>vjust</code> controls horizontal and vertical placement, receptively.<code>angle</code> rotates the text and <code>lineheight</code> controls the distance between lines (we have used <code>\n</code> to indicate a new line in the title).</p>
<p>Similarly to <code>element_text</code>, <code>element_rect</code> contains argument to control rectangular elements and <code>element_line</code> is used to control lines. <code>element_blank</code> is used to remove an element, we already used this above to remove the x axis title. In the same “family” of function we find <code>margin</code> which can specify margins of theme elements.</p>
<p>In addition to controlling specific elements of a theme we have the option to use ready made themes. A couple of pre-specified themes are shipped with <code>ggplot2</code> (see <a href="#fig-theme-example">Figure&nbsp;<span>1.4</span></a>)</p>
<div class="cell">
<details>
<summary>Code producing the figure</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> leg_leanmass <span class="sc">|&gt;</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(include <span class="sc">!=</span> <span class="st">"excl"</span>) <span class="sc">|&gt;</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">factor</span>(time, </span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"pre"</span>, <span class="st">"post"</span>))) <span class="sc">|&gt;</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(time, lean_mass, <span class="at">fill =</span> volume)) <span class="sc">+</span> </span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time"</span>, </span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Leg lean</span><span class="sc">\n</span><span class="st">mass (g)"</span>, </span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Volume condition"</span>, </span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"The plot subtitle"</span>, </span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"the plot caption"</span>) <span class="sc">+</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Pre</span><span class="sc">\n</span><span class="st">intervention"</span>, </span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Post</span><span class="sc">\n</span><span class="st">intervention"</span>))</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(p <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"theme_bw"</span>), </span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>          p <span class="sc">+</span> <span class="fu">theme_classic</span>()<span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"theme_classic"</span>), </span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>          p <span class="sc">+</span> <span class="fu">theme_minimal</span>()<span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"theme_minimal"</span>), </span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a>          p <span class="sc">+</span> <span class="fu">theme_dark</span>()<span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"theme_dark"</span>), </span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a>          p <span class="sc">+</span> <span class="fu">theme_light</span>()<span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"theme_light"</span>), </span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a>          p <span class="sc">+</span> <span class="fu">theme_linedraw</span>()<span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"theme_linedraw"</span>), </span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a>          p <span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"theme_bw"</span>), </span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a>          p <span class="sc">+</span> <span class="fu">theme_grey</span>()<span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"theme_grey"</span>), </span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a>          p <span class="sc">+</span> <span class="fu">theme_void</span>()<span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"theme_void"</span>), </span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-theme-example" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="data-viz_files/figure-html/fig-theme-example-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1.4: Examples of themes that are part of <code>ggplot2</code></figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="scientific-graphic-design" class="level2 page-columns page-full" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="scientific-graphic-design"><span class="header-section-number">1.4</span> Scientific graphic design</h2>
<p>An important rule of scientific graphics is, not to lie. Or as stated by Tufte <span class="citation" data-cites="tufte2001">(<a href="references.html#ref-tufte2001" role="doc-biblioref">2001</a>)</span>, “graphical excellence begins with telling the truth about the data”. Clear and honest representation of the data together with detailed labeling are key factors for avoiding lies <span class="citation" data-cites="tufte2001">(<a href="references.html#ref-tufte2001" role="doc-biblioref">Tufte 2001</a>)</span>.</p>
<div class="no-row-height column-margin column-container"></div><p>Another key aspect in the construction of scientific graphs is to decide what to plot. Graphs are very good at showing differences, however, what differences should be show? In a two-group design (treatment vs.&nbsp;control) we should aim at showing the difference between groups, not the difference within groups <span class="citation" data-cites="ho2019">(<a href="references.html#ref-ho2019" role="doc-biblioref">Ho et al. 2019</a>)</span>. When data are grouped, or measurements repeated within experimental units (such as research participants), we should show aim at indicating this fact. When graphical summaries are shown, we should also aim at showing the underlying data<span class="citation" data-cites="tufte2001">(<a href="references.html#ref-tufte2001" role="doc-biblioref">Tufte 2001</a>)</span>.</p>
<section id="revise-and-edit" class="level3 page-columns page-full" data-number="1.4.1">
<h3 data-number="1.4.1" class="anchored" data-anchor-id="revise-and-edit"><span class="header-section-number">1.4.1</span> Revise and edit</h3>
<p>When trying to find a coherent guide for scientific graphics one quickly realize that guidelines are often in conflict with each other. We have to reach some pragmatic level of compromise in our work. How do we find this compromise? Tufte’s advice to constantly revise and edit is a good start <span class="citation" data-cites="tufte2001">(<a href="references.html#ref-tufte2001" role="doc-biblioref">Tufte 2001</a>)</span>. Like with writing we try to explain or show, but fail to do so. Multiple edits later our text is ready to communicate an idea to others, and we might have learned something too.</p>
<div class="no-row-height column-margin column-container"><div id="ref-tufte2001" class="csl-entry" role="listitem">
Tufte, Edward R. 2001. <em>The Visual Display of Quantitative Information</em>. 2. edition. Cheshire, Conn.: Graphics Press.
</div></div><p>In practice a graph, or a collection of graphs are born from multiple revisions. Below we will revise our graph using a number of principles outlined by Tufte <span class="citation" data-cites="tufte2001">(<a href="references.html#ref-tufte2001" role="doc-biblioref">Tufte 2001</a>)</span>.</p>
<section id="show-the-data" class="level4" data-number="1.4.1.1">
<h4 data-number="1.4.1.1" class="anchored" data-anchor-id="show-the-data"><span class="header-section-number">1.4.1.1</span> Show the data</h4>
<p>Our original idea is shown below. We made a box-plot of raw lean mass values. A core shortcoming of this graph is that it hides uncertainty our sample size. We could add another layer on top of our bow-plots to show raw data. The geom <code>geom_point</code> is added with the additional arguments: <code>shape = 21, position =position_jitterdodge(dodge.width = 0.75, jitter.width = 0.1)</code>. The change in shape creates the possibility to fill points. As we have specified fill in aesthetics each point will have a condition-wise fill.</p>
<div class="cell">
<details>
<summary>Code producing the figure</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>leg_leanmass <span class="sc">|&gt;</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(include <span class="sc">!=</span> <span class="st">"excl"</span>) <span class="sc">|&gt;</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">factor</span>(time, </span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"pre"</span>, <span class="st">"post"</span>))) <span class="sc">|&gt;</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(time, lean_mass, <span class="at">fill =</span> volume)) <span class="sc">+</span> </span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">position =</span> <span class="fu">position_jitterdodge</span>(<span class="at">dodge.width =</span> <span class="fl">0.75</span>, </span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>                                                         <span class="at">jitter.width =</span> <span class="fl">0.1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="data-viz_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">A boxplot with raw data plotted on top</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Are we showing the data now? Some aspects of the data are still lost. The fact that the experiment is a nested one is not obvious from this display. Could we connect related data points?</p>
<p>In the next graph we’ll try another alternative, using a line-graph we might be able to convey an aspect of the repeated measures design. We will also add a facet to show each volume condition.</p>
<div class="cell">
<details>
<summary>Code producing the figure</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>leg_leanmass <span class="sc">|&gt;</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(include <span class="sc">!=</span> <span class="st">"excl"</span>) <span class="sc">|&gt;</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">factor</span>(time, </span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"pre"</span>, <span class="st">"post"</span>))) <span class="sc">|&gt;</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(time, lean_mass, <span class="at">fill =</span> volume, <span class="at">group =</span> participant)) <span class="sc">+</span> </span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> </span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> volume)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="data-viz_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">A line graph grouping observations per participant and volume condition</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>But what is the real comparison here? Here we might actually display within-condition differences. The analog to statistical test might be that we show two within-condition t-tests and tell the reader that the effect in one group is greater than the other. This is not an honest test.</p>
<p>To revise further we might want to compare changes across conditions. We can do this and still highlight comparisons within participants since each participant performed both conditions. To accomplish this we need some data wrangling.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-50"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-50-1"><a href="#annotated-cell-50-1" aria-hidden="true" tabindex="-1"></a>delta_lean <span class="ot">&lt;-</span> leg_leanmass <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-50" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-50-2" class="code-annotation-target"><a href="#annotated-cell-50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(include <span class="sc">!=</span> <span class="st">"excl"</span>) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-50" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-50-3" class="code-annotation-target"><a href="#annotated-cell-50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> time, <span class="at">values_from =</span> lean_mass) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-50" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-50-4" class="code-annotation-target"><a href="#annotated-cell-50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">delta =</span> post <span class="sc">-</span> pre) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-50-5"><a href="#annotated-cell-50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-50" data-target-annotation="1">1</dt>
<dd>
<span data-code-lines="2" data-code-cell="annotated-cell-50" data-code-annotation="1">Using only included participants from our raw data set we first…</span>
</dd>
<dt data-target-cell="annotated-cell-50" data-target-annotation="2">2</dt>
<dd>
<span data-code-lines="3" data-code-cell="annotated-cell-50" data-code-annotation="2">create a wide data set by time allowing for…</span>
</dd>
<dt data-target-cell="annotated-cell-50" data-target-annotation="3">3</dt>
<dd>
<span data-code-lines="4" data-code-cell="annotated-cell-50" data-code-annotation="3">a simple difference across time in each participant and condition.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 68 × 7
   participant include leg   volume     pre  post delta
   &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 FP28        incl    L     multiple  7059  7273   214
 2 FP28        incl    R     single    7104  7227   123
 3 FP40        incl    L     single    7190  7192     2
 4 FP40        incl    R     multiple  7506  7437   -69
 5 FP21        incl    L     single   10281 10470   189
 6 FP21        incl    R     multiple 10200 10819   619
 7 FP34        incl    L     single    6014  6326   312
 8 FP34        incl    R     multiple  6009  6405   396
 9 FP23        incl    L     single    8242  8687   445
10 FP23        incl    R     multiple  8685  8480  -205
# ℹ 58 more rows</code></pre>
</div>
</div>
<p>We have saved the data set in a new object called <code>delta_lean</code> we will use this for plotting.</p>
<div class="cell">
<details>
<summary>Code producing the figure</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>delta_lean <span class="sc">|&gt;</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(volume, delta, <span class="at">fill =</span> volume, <span class="at">group =</span> participant)) <span class="sc">+</span> </span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="data-viz_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">A line graph grouped by participant comparing conditions</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>It could be argued that the order of the factor variable <code>volume</code> is not accurately representing the data. Multiple is larger than single and the graph might be more accurate in this respect if we change this variable. I will do it as a pre-plotting operation. We may then also change the labels.</p>
<div class="cell">
<details>
<summary>Code producing the figure</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>delta_lean <span class="sc">|&gt;</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">volume =</span> <span class="fu">factor</span>(volume, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"single"</span>, <span class="st">"multiple"</span>), </span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Low-volume"</span>, <span class="st">"Moderate-volume"</span>))) <span class="sc">|&gt;</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(volume, delta, </span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> volume, </span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> participant)) <span class="sc">+</span> </span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="data-viz_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">A line graph grouped by participant comparing conditions</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="maximize-the-data-ink-ratio" class="level4" data-number="1.4.1.2">
<h4 data-number="1.4.1.2" class="anchored" data-anchor-id="maximize-the-data-ink-ratio"><span class="header-section-number">1.4.1.2</span> Maximize the data-ink ratio</h4>
<p>A guiding principle in Tufte’ guideline is to remove non-data ink. We should aim to maximize the amount of ink used to display the data. Non-data ink can be removed by manipulating theme components. A great start might be to use a built in theme, <code>theme_minimal</code>.</p>
<div class="cell">
<details>
<summary>Code producing the figure</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>delta_lean <span class="sc">|&gt;</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">volume =</span> <span class="fu">factor</span>(volume, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"single"</span>, <span class="st">"multiple"</span>), </span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Low-volume"</span>, <span class="st">"Moderate-volume"</span>))) <span class="sc">|&gt;</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(volume, delta, </span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> volume, </span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> participant)) <span class="sc">+</span> </span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="data-viz_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">A line graph grouped by participant comparing conditions, reducing non-data ink with <code>theme_minimal</code>.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The legend is redundant, it can be removed since this information is already present in the x axis. The x-axis title is redundant as the information is duplicated in the labels. Some grid lines can be removed without loss of information, maybe even all of them. Let’s add a line manually to show the 0 change. We can access these options using the <code>theme</code> function and elements manipulated therein. Placing the <code>theme</code> after <code>theme_minimal</code> in our call makes sure that we don’t bring back elements from the pre-built theme. Let’s also add a more descriptive label on the y-axis.</p>
<div class="cell">
<details>
<summary>Code producing the figure</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>delta_lean <span class="sc">|&gt;</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">volume =</span> <span class="fu">factor</span>(volume, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"single"</span>, <span class="st">"multiple"</span>), </span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Low-volume"</span>, <span class="st">"Moderate-volume"</span>))) <span class="sc">|&gt;</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(volume, delta, </span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> volume, </span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> participant)) <span class="sc">+</span> </span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"gray90"</span>) <span class="sc">+</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Change in lean mass from pre- to post-intervention (g)"</span>) <span class="sc">+</span></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, </span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="data-viz_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">A line graph grouped by participant comparing conditions, reducing non-data ink with <code>theme_minimal</code>.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="erase-redundant-data-ink" class="level4" data-number="1.4.1.3">
<h4 data-number="1.4.1.3" class="anchored" data-anchor-id="erase-redundant-data-ink"><span class="header-section-number">1.4.1.3</span> Erase redundant data ink</h4>
<p>We have used points to represent the start and end of each line. This might be a case of redundant data ink.</p>
<div class="cell">
<details>
<summary>Code producing the figure</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>delta_lean <span class="sc">|&gt;</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">volume =</span> <span class="fu">factor</span>(volume, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"single"</span>, <span class="st">"multiple"</span>), </span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Low-volume"</span>, <span class="st">"Moderate-volume"</span>))) <span class="sc">|&gt;</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(volume, delta, </span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> volume, </span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> participant)) <span class="sc">+</span> </span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"gray90"</span>) <span class="sc">+</span></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Change in lean mass from pre- to post-intervention (g)"</span>) <span class="sc">+</span></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, </span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="data-viz_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">A line graph grouped by participant comparing conditions, reducing non-data ink with <code>theme_minimal</code> and removing redundant data ink by removing points.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>To make the graph even more light weight we could consider making lines a bit transparent. Using <code>alpha = 0.5</code> we can add transparency to lines.</p>
<div class="cell">
<details>
<summary>Code producing the figure</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>delta_lean <span class="sc">|&gt;</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">volume =</span> <span class="fu">factor</span>(volume, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"single"</span>, <span class="st">"multiple"</span>), </span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Low-volume"</span>, <span class="st">"Moderate-volume"</span>))) <span class="sc">|&gt;</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(volume, delta, </span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> volume, </span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> participant)) <span class="sc">+</span> </span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"gray90"</span>) <span class="sc">+</span></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Change in lean mass from pre- to post-intervention (g)"</span>) <span class="sc">+</span></span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, </span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="data-viz_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">A line graph grouped by participant comparing conditions, reducing non-data ink with <code>theme_minimal</code> and removing redundant data ink by removing points and adding transparency.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="making-comparisons" class="level4 page-columns page-full" data-number="1.4.1.4">
<h4 data-number="1.4.1.4" class="anchored" data-anchor-id="making-comparisons"><span class="header-section-number">1.4.1.4</span> Making comparisons</h4>
<p>We now have a graph that represents the data, could we aid interpreting the figure? Perhaps we could add some information showing average changes per condition? Below we will construct a data frame of averages for each condition and add it to the figure.</p>
<div class="cell">
<details>
<summary>Code producing the figure</summary>
<div class="sourceCode cell-code" id="annotated-cell-57"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-57-1"><a href="#annotated-cell-57-1" aria-hidden="true" tabindex="-1"></a>descriptives <span class="ot">&lt;-</span> delta_lean <span class="sc">|&gt;</span></span>
<span id="annotated-cell-57-2"><a href="#annotated-cell-57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">volume =</span> <span class="fu">factor</span>(volume, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"single"</span>, <span class="st">"multiple"</span>), </span>
<span id="annotated-cell-57-3"><a href="#annotated-cell-57-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Low-volume"</span>, <span class="st">"Moderate-volume"</span>))) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-57-4"><a href="#annotated-cell-57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">.by =</span> volume, </span>
<span id="annotated-cell-57-5"><a href="#annotated-cell-57-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">m =</span> <span class="fu">mean</span>(delta))</span>
<span id="annotated-cell-57-6"><a href="#annotated-cell-57-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-57-7"><a href="#annotated-cell-57-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-57-8"><a href="#annotated-cell-57-8" aria-hidden="true" tabindex="-1"></a>delta_lean <span class="sc">|&gt;</span></span>
<span id="annotated-cell-57-9"><a href="#annotated-cell-57-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-57-10"><a href="#annotated-cell-57-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">volume =</span> <span class="fu">factor</span>(volume, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"single"</span>, <span class="st">"multiple"</span>), </span>
<span id="annotated-cell-57-11"><a href="#annotated-cell-57-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Low-volume"</span>, <span class="st">"Moderate-volume"</span>))) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-57-12"><a href="#annotated-cell-57-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-57-13"><a href="#annotated-cell-57-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(volume, delta, </span>
<span id="annotated-cell-57-14"><a href="#annotated-cell-57-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> volume, </span>
<span id="annotated-cell-57-15"><a href="#annotated-cell-57-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> participant)) <span class="sc">+</span> </span>
<span id="annotated-cell-57-16"><a href="#annotated-cell-57-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-57-17"><a href="#annotated-cell-57-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"gray90"</span>) <span class="sc">+</span></span>
<span id="annotated-cell-57-18"><a href="#annotated-cell-57-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-57-19"><a href="#annotated-cell-57-19" aria-hidden="true" tabindex="-1"></a>  </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-57" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-57-20" class="code-annotation-target"><a href="#annotated-cell-57-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">filter</span>(descriptives, volume<span class="sc">==</span> <span class="st">"Low-volume"</span>),</span>
<span id="annotated-cell-57-21"><a href="#annotated-cell-57-21" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">aes</span>(volume, m, <span class="at">group =</span> <span class="cn">NULL</span>, <span class="at">fill =</span> <span class="cn">NULL</span>), </span>
<span id="annotated-cell-57-22"><a href="#annotated-cell-57-22" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="annotated-cell-57-23"><a href="#annotated-cell-57-23" aria-hidden="true" tabindex="-1"></a>  </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-57" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-57-24" class="code-annotation-target"><a href="#annotated-cell-57-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">filter</span>(descriptives, volume<span class="sc">==</span> <span class="st">"Moderate-volume"</span>),</span>
<span id="annotated-cell-57-25"><a href="#annotated-cell-57-25" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">aes</span>(volume, m, <span class="at">group =</span> <span class="cn">NULL</span>, <span class="at">fill =</span> <span class="cn">NULL</span>), </span>
<span id="annotated-cell-57-26"><a href="#annotated-cell-57-26" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="annotated-cell-57-27"><a href="#annotated-cell-57-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-57-28"><a href="#annotated-cell-57-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-57-29"><a href="#annotated-cell-57-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-57-30"><a href="#annotated-cell-57-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="annotated-cell-57-31"><a href="#annotated-cell-57-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-57-32"><a href="#annotated-cell-57-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-57-33"><a href="#annotated-cell-57-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Change in lean mass from pre- to post-intervention (g)"</span>) <span class="sc">+</span></span>
<span id="annotated-cell-57-34"><a href="#annotated-cell-57-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-57-35"><a href="#annotated-cell-57-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="annotated-cell-57-36"><a href="#annotated-cell-57-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-57-37"><a href="#annotated-cell-57-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, </span>
<span id="annotated-cell-57-38"><a href="#annotated-cell-57-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(), </span>
<span id="annotated-cell-57-39"><a href="#annotated-cell-57-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(), </span>
<span id="annotated-cell-57-40"><a href="#annotated-cell-57-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(), </span>
<span id="annotated-cell-57-41"><a href="#annotated-cell-57-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>())</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-57" data-target-annotation="1">1</dt>
<dd>
<span data-code-lines="20" data-code-cell="annotated-cell-57" data-code-annotation="1">Two point layers are added to make it easy to plot points besides lines. Notice that the x-axis factor must be correctly formatted</span>
</dd>
<dt data-target-cell="annotated-cell-57" data-target-annotation="2">2</dt>
<dd>
<span data-code-lines="24" data-code-cell="annotated-cell-57" data-code-annotation="2">The other point layer, here position_nudge is positive.</span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="data-viz_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">A line graph grouped by participant comparing conditions, reducing non-data ink with <code>theme_minimal</code> and removing redundant data ink by removing points and adding transparency. Adding group averages with geom_point.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Again, we might not be giving the reader of the graph the full story. Recently a new type of graph has been suggested to aid interpretation of two-group comparisons. In addition to means we could add the estimate of the difference between groups. These plots are called estimation plots <span class="citation" data-cites="ho2019">(<a href="references.html#ref-ho2019" role="doc-biblioref">Ho et al. 2019</a>)</span>. In our previous work we used different variations of ANCOVA models to adjust for baseline values <span class="citation" data-cites="hammarstrom2020">(<a href="references.html#ref-hammarstrom2020" role="doc-biblioref">Hammarström et al. 2020</a>)</span> while modelling the change score. Let’s start by fitting the model. Since the design is a bit tricky we need to let the model know that observations are grouped by participant. We can use the same <code>delta_lean</code> data set to fit the model.</p>
<div class="no-row-height column-margin column-container"><div id="ref-ho2019" class="csl-entry" role="listitem">
Ho, Joses, Tayfun Tumkaya, Sameer Aryal, Hyungwon Choi, and Adam Claridge-Chang. 2019. <span>“Moving Beyond P Values: Data Analysis with Estimation Graphics.”</span> <em>Nature Methods</em> 16 (7): 565–66. <a href="https://doi.org/10.1038/s41592-019-0470-3">https://doi.org/10.1038/s41592-019-0470-3</a>.
</div><div id="ref-hammarstrom2020" class="csl-entry" role="listitem">
Hammarström, Daniel, Sjur Øfsteng, Lise Koll, Marita Hanestadhaugen, Ivana Hollan, William Apró, Jon Elling Whist, Eva Blomstrand, Bent R. Rønnestad, and Stian Ellefsen. 2020. <span>“Benefits of higher resistance-training volume are related to ribosome biogenesis.”</span> <em>The Journal of physiology</em> 598 (3): 543–65. <a href="https://doi.org/10.1113/JP278455">https://doi.org/10.1113/JP278455</a>.
</div></div><div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-58"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-58-1"><a href="#annotated-cell-58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="annotated-cell-58-2"><a href="#annotated-cell-58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-58-3"><a href="#annotated-cell-58-3" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lmer</span>(delta <span class="sc">~</span> <span class="fu">scale</span>(pre) <span class="sc">+</span> volume <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>participant), </span>
<span id="annotated-cell-58-4"><a href="#annotated-cell-58-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> delta_lean)</span>
<span id="annotated-cell-58-5"><a href="#annotated-cell-58-5" aria-hidden="true" tabindex="-1"></a></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-58" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-58-6" class="code-annotation-target"><a href="#annotated-cell-58-6" aria-hidden="true" tabindex="-1"></a>mod_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(<span class="fu">coef</span>(<span class="fu">summary</span>(mod)), <span class="fu">confint</span>(mod)[<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, ]))</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-58" data-target-annotation="1">1</dt>
<dd>
<span data-code-lines="6" data-code-cell="annotated-cell-58" data-code-annotation="1">The output from the model is saved in a new object, including confidence intervals for each coefficient.</span>
</dd>
</dl>
</div>
</div>
<p>Our model gives us one coefficient of interest, <code>volumesingle</code>. This is the difference between <code>multiple</code> and <code>single</code> sets change in lean mass. This coefficient has an accompanying confidence interval that can be used for inference. Let’s add the difference between groups as an additional point to the plot together with a confidence interval and a second scale.</p>
<div class="cell">
<details>
<summary>Code producing the figure</summary>
<div class="sourceCode cell-code" id="annotated-cell-59"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-59-1"><a href="#annotated-cell-59-1" aria-hidden="true" tabindex="-1"></a>descriptives <span class="ot">&lt;-</span> delta_lean <span class="sc">|&gt;</span></span>
<span id="annotated-cell-59-2"><a href="#annotated-cell-59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">volume =</span> <span class="fu">factor</span>(volume, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"single"</span>, <span class="st">"multiple"</span>), </span>
<span id="annotated-cell-59-3"><a href="#annotated-cell-59-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Low-volume"</span>, <span class="st">"Moderate-volume"</span>))) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-59-4"><a href="#annotated-cell-59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">.by =</span> volume, </span>
<span id="annotated-cell-59-5"><a href="#annotated-cell-59-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">m =</span> <span class="fu">mean</span>(delta))</span>
<span id="annotated-cell-59-6"><a href="#annotated-cell-59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-59-7"><a href="#annotated-cell-59-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-59-8"><a href="#annotated-cell-59-8" aria-hidden="true" tabindex="-1"></a></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-59" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-59-9" class="code-annotation-target"><a href="#annotated-cell-59-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-59-10"><a href="#annotated-cell-59-10" aria-hidden="true" tabindex="-1"></a>zero <span class="ot">&lt;-</span> descriptives <span class="sc">|&gt;</span></span>
<span id="annotated-cell-59-11"><a href="#annotated-cell-59-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(volume <span class="sc">==</span> <span class="st">"Low-volume"</span>) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-59-12"><a href="#annotated-cell-59-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(m)</span>
<span id="annotated-cell-59-13"><a href="#annotated-cell-59-13" aria-hidden="true" tabindex="-1"></a></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-59" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-59-14" class="code-annotation-target"><a href="#annotated-cell-59-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-59-15"><a href="#annotated-cell-59-15" aria-hidden="true" tabindex="-1"></a>est <span class="ot">&lt;-</span> zero <span class="sc">+</span> (<span class="sc">-</span> mod_results[<span class="dv">3</span>,<span class="dv">1</span>])</span>
<span id="annotated-cell-59-16"><a href="#annotated-cell-59-16" aria-hidden="true" tabindex="-1"></a>ciu <span class="ot">&lt;-</span> <span class="sc">-</span> mod_results[<span class="dv">3</span>,<span class="dv">4</span>] <span class="sc">+</span> zero</span>
<span id="annotated-cell-59-17"><a href="#annotated-cell-59-17" aria-hidden="true" tabindex="-1"></a>cil <span class="ot">&lt;-</span> <span class="sc">-</span> mod_results[<span class="dv">3</span>,<span class="dv">5</span>] <span class="sc">+</span> zero</span>
<span id="annotated-cell-59-18"><a href="#annotated-cell-59-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-59-19"><a href="#annotated-cell-59-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-59-20"><a href="#annotated-cell-59-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-59-21"><a href="#annotated-cell-59-21" aria-hidden="true" tabindex="-1"></a>delta_lean <span class="sc">|&gt;</span></span>
<span id="annotated-cell-59-22"><a href="#annotated-cell-59-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-59-23"><a href="#annotated-cell-59-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">volume =</span> <span class="fu">factor</span>(volume, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"single"</span>, <span class="st">"multiple"</span>), </span>
<span id="annotated-cell-59-24"><a href="#annotated-cell-59-24" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Low-volume"</span>, <span class="st">"Moderate-volume"</span>))) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-59-25"><a href="#annotated-cell-59-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-59-26"><a href="#annotated-cell-59-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(volume, delta, </span>
<span id="annotated-cell-59-27"><a href="#annotated-cell-59-27" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="annotated-cell-59-28"><a href="#annotated-cell-59-28" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> participant)) <span class="sc">+</span> </span>
<span id="annotated-cell-59-29"><a href="#annotated-cell-59-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-59-30"><a href="#annotated-cell-59-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="annotated-cell-59-31"><a href="#annotated-cell-59-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">filter</span>(descriptives, volume<span class="sc">==</span> <span class="st">"Low-volume"</span>),</span>
<span id="annotated-cell-59-32"><a href="#annotated-cell-59-32" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">aes</span>(volume, m, <span class="at">group =</span> <span class="cn">NULL</span>, <span class="at">fill =</span> <span class="cn">NULL</span>), </span>
<span id="annotated-cell-59-33"><a href="#annotated-cell-59-33" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="annotated-cell-59-34"><a href="#annotated-cell-59-34" aria-hidden="true" tabindex="-1"></a>  </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-59" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-59-35" class="code-annotation-target"><a href="#annotated-cell-59-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-59-36"><a href="#annotated-cell-59-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">y =</span> zero, <span class="at">yend =</span> zero, <span class="at">x =</span> <span class="fl">0.95</span>, <span class="at">xend =</span> <span class="fl">2.2</span>, <span class="at">color =</span> <span class="st">"gray50"</span>, </span>
<span id="annotated-cell-59-37"><a href="#annotated-cell-59-37" aria-hidden="true" tabindex="-1"></a>               <span class="at">lty =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-59" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="annotated-cell-59-38" class="code-annotation-target"><a href="#annotated-cell-59-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-59-39"><a href="#annotated-cell-59-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">y =</span> est, <span class="at">ymin =</span> cil, </span>
<span id="annotated-cell-59-40"><a href="#annotated-cell-59-40" aria-hidden="true" tabindex="-1"></a>                <span class="at">ymax =</span> ciu, <span class="at">x =</span> <span class="fl">2.1</span>), </span>
<span id="annotated-cell-59-41"><a href="#annotated-cell-59-41" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="annotated-cell-59-42"><a href="#annotated-cell-59-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-59-43"><a href="#annotated-cell-59-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-59-44"><a href="#annotated-cell-59-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">filter</span>(descriptives, volume<span class="sc">==</span> <span class="st">"Moderate-volume"</span>),</span>
<span id="annotated-cell-59-45"><a href="#annotated-cell-59-45" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">aes</span>(volume, m, <span class="at">group =</span> <span class="cn">NULL</span>, <span class="at">fill =</span> <span class="cn">NULL</span>), </span>
<span id="annotated-cell-59-46"><a href="#annotated-cell-59-46" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="fl">0.1</span>), </span>
<span id="annotated-cell-59-47"><a href="#annotated-cell-59-47" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">24</span>, </span>
<span id="annotated-cell-59-48"><a href="#annotated-cell-59-48" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">2</span>, </span>
<span id="annotated-cell-59-49"><a href="#annotated-cell-59-49" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">"gray60"</span>) <span class="sc">+</span></span>
<span id="annotated-cell-59-50"><a href="#annotated-cell-59-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-59-51"><a href="#annotated-cell-59-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-59-52"><a href="#annotated-cell-59-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-59-53"><a href="#annotated-cell-59-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="annotated-cell-59-54"><a href="#annotated-cell-59-54" aria-hidden="true" tabindex="-1"></a> </span>
<span id="annotated-cell-59-55"><a href="#annotated-cell-59-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Change in lean mass from pre- to post-intervention (g)"</span>) <span class="sc">+</span></span>
<span id="annotated-cell-59-56"><a href="#annotated-cell-59-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-59-57"><a href="#annotated-cell-59-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="annotated-cell-59-58"><a href="#annotated-cell-59-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-59-59"><a href="#annotated-cell-59-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, </span>
<span id="annotated-cell-59-60"><a href="#annotated-cell-59-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(), </span>
<span id="annotated-cell-59-61"><a href="#annotated-cell-59-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(), </span>
<span id="annotated-cell-59-62"><a href="#annotated-cell-59-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(), </span>
<span id="annotated-cell-59-63"><a href="#annotated-cell-59-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>())</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-59" data-target-annotation="1">1</dt>
<dd>
<span data-code-lines="9,31" data-code-cell="annotated-cell-59" data-code-annotation="1">A “zero line” is created from the descriptive data in the low-volume group</span>
</dd>
<dt data-target-cell="annotated-cell-59" data-target-annotation="2">2</dt>
<dd>
<span data-code-lines="14,44" data-code-cell="annotated-cell-59" data-code-annotation="2">The confidence interval is “corrected” to the observed data as the model CI only shows the differences between groups. Notice that estimates are reversed in the model.</span>
</dd>
<dt data-target-cell="annotated-cell-59" data-target-annotation="3">3</dt>
<dd>
<span data-code-lines="35" data-code-cell="annotated-cell-59" data-code-annotation="3">A segment is added to represent the “zero line”, the mean in low-volume.</span>
</dd>
<dt data-target-cell="annotated-cell-59" data-target-annotation="4">4</dt>
<dd>
<span data-code-lines="38" data-code-cell="annotated-cell-59" data-code-annotation="4">An errorbar is used around the descriptive data for the moderate volume group.</span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="data-viz_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">A line graph grouped by participant comparing conditions, reducing non-data ink with <code>theme_minimal</code> and removing redundant data ink by removing points and adding transparency. Adding group averages with geom_point.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The resulting graph shows the change from pre- to post-intervention in each condition per participant by lines. The average at the reference category represents a baseline to which the moderate volume condition is compared. Inference can be made from a 95% confidence interval around the moderate-volume condition.</p>
</section>
</section>
</section>
<section id="edit-and-revise-in-practice" class="level2 page-columns page-full" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="edit-and-revise-in-practice"><span class="header-section-number">1.5</span> Edit and revise in practice</h2>
<p>The process of creating graphs is an iterative practice. We try something, edit and revise. When the end result goes into a publication it is a good idea to have a workflow that updates the end result not some intermediate result.</p>
<div class="page-columns page-full"><p>Let us say that we are planning to submit a paper to the American Journal of Physiology. In the author instruction we read that a single column figure should be less or equal to 8.9 cm in width and a maximum 22.8 in height/depth.<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a> This gives some basics instructions for our plot.</p><div class="no-row-height column-margin column-container"><li id="fn9"><p><sup>9</sup>&nbsp;See https://journals.physiology.org/manuscript-prep#figures</p></li></div></div>
<p>Graphs could be created from separate R scripts. This makes the workflow smoother as we only need to run a single script to recreate the output after revision. I keep my figures together with the scripts in a dedicated folder in my project folder called figures. Here I number figures and their corresponding scripts as <code>figure1.R</code>, <code>figure1.pdf</code>, <code>figure2.R</code> etc.</p>
<p>On the bottom of the script I have a call to the function <code>ggsave</code>. This function makes it easy to save a ggplot in a number of formats, also formats accepted by journals (such as TIF and PDF).</p>
<p>When I make changes to the script and saves them they are automatically sourced and the output is recreated.</p>
</section>
<section id="additional-notes-tips-and-topics" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="additional-notes-tips-and-topics"><span class="header-section-number">1.6</span> Additional notes, tips and topics</h2>
<section id="labels-annotations-and-special-texts" class="level3" data-number="1.6.1">
<h3 data-number="1.6.1" class="anchored" data-anchor-id="labels-annotations-and-special-texts"><span class="header-section-number">1.6.1</span> Labels, annotations and special texts</h3>
<p>A package called <code>ggtext</code> makes it possible to write markdown syntax in labels and annotation in ggplots. This improves usability to a large degree as subscripts and superscrits together with special characters are easily added to labels etc.</p>
<p>Sometimes custom fonts are needed. Your basic collection of fonts are not that impressive but packages such as <code>showtext</code> may help in installing additional fonts.</p>
<div class="cell">
<details>
<summary>Code producing the figure</summary>
<div class="sourceCode cell-code" id="annotated-cell-60"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-60-1"><a href="#annotated-cell-60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(showtext)</span>
<span id="annotated-cell-60-2"><a href="#annotated-cell-60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-60-3"><a href="#annotated-cell-60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">font_add_google</span>(<span class="at">name =</span> <span class="st">"Permanent Marker"</span>, </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-60" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-60-4" class="code-annotation-target"><a href="#annotated-cell-60-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> <span class="st">"permanentmarker"</span>)</span>
<span id="annotated-cell-60-5"><a href="#annotated-cell-60-5" aria-hidden="true" tabindex="-1"></a><span class="fu">showtext_auto</span>()</span>
<span id="annotated-cell-60-6"><a href="#annotated-cell-60-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-60-7"><a href="#annotated-cell-60-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-60-8"><a href="#annotated-cell-60-8" aria-hidden="true" tabindex="-1"></a>leg_leanmass <span class="sc">|&gt;</span></span>
<span id="annotated-cell-60-9"><a href="#annotated-cell-60-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(include <span class="sc">!=</span> <span class="st">"excl"</span>) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-60-10"><a href="#annotated-cell-60-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">factor</span>(time, </span>
<span id="annotated-cell-60-11"><a href="#annotated-cell-60-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"pre"</span>, <span class="st">"post"</span>))) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-60-12"><a href="#annotated-cell-60-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-60-13"><a href="#annotated-cell-60-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(time, lean_mass, <span class="at">fill =</span> volume)) <span class="sc">+</span> </span>
<span id="annotated-cell-60-14"><a href="#annotated-cell-60-14" aria-hidden="true" tabindex="-1"></a>         <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="annotated-cell-60-15"><a href="#annotated-cell-60-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-60-16"><a href="#annotated-cell-60-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time"</span>, </span>
<span id="annotated-cell-60-17"><a href="#annotated-cell-60-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Leg lean</span><span class="sc">\n</span><span class="st">mass (g)"</span>, </span>
<span id="annotated-cell-60-18"><a href="#annotated-cell-60-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Volume condition"</span>, </span>
<span id="annotated-cell-60-19"><a href="#annotated-cell-60-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"The plot title"</span>, </span>
<span id="annotated-cell-60-20"><a href="#annotated-cell-60-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"The plot subtitle"</span>, </span>
<span id="annotated-cell-60-21"><a href="#annotated-cell-60-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"the plot caption"</span>) <span class="sc">+</span></span>
<span id="annotated-cell-60-22"><a href="#annotated-cell-60-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-60-23"><a href="#annotated-cell-60-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Pre</span><span class="sc">\n</span><span class="st">intervention"</span>, </span>
<span id="annotated-cell-60-24"><a href="#annotated-cell-60-24" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Post</span><span class="sc">\n</span><span class="st">intervention"</span>)) <span class="sc">+</span></span>
<span id="annotated-cell-60-25"><a href="#annotated-cell-60-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-60-26"><a href="#annotated-cell-60-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-60-27"><a href="#annotated-cell-60-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(), </span>
<span id="annotated-cell-60-28"><a href="#annotated-cell-60-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="annotated-cell-60-29"><a href="#annotated-cell-60-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-60" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-60-30" class="code-annotation-target"><a href="#annotated-cell-60-30" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">family =</span> <span class="st">"permanentmarker"</span>,</span>
<span id="annotated-cell-60-31"><a href="#annotated-cell-60-31" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">size =</span> <span class="dv">40</span>))</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-60" data-target-annotation="1">1</dt>
<dd>
<span data-code-lines="4" data-code-cell="annotated-cell-60" data-code-annotation="1">This “installs” the font on your system.</span>
</dd>
<dt data-target-cell="annotated-cell-60" data-target-annotation="2">2</dt>
<dd>
<span data-code-lines="30" data-code-cell="annotated-cell-60" data-code-annotation="2">Specifying a font family, use your own specified name to access it.</span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="data-viz_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Adding a silly font to a basic graph</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="glamorous-graphics" class="level3" data-number="1.6.2">
<h3 data-number="1.6.2" class="anchored" data-anchor-id="glamorous-graphics"><span class="header-section-number">1.6.2</span> Glamorous graphics</h3>
<p>In a talk at RStudio conference in 2020, Will Chase presented principles related to glamorous graphics. In contrast to Tufte’s principles (discussed above), glamorous graphics suggest adding ink to increase the attractiveness of graphics. (This might be a topic for a later workshop).</p>
<!-- 
Why glamorous graphics? - Engage a wider audience - Aesthetics matters for understanding - "respecting the audience"

The glamour of graphics uses color, typography and layout to increase the impact of the graphic.

### Layout

#### Alignment

Top left align titles

Text should be horizontal

Axis labels should also be horizontal

Alignment should provide clean lines and symmetry

Some alignment can be left/center/right to provide overall structure to the graph.

#### Border, Grid lines, legends

Do not use borders or grid lines. If grid lines, make them lighter and more subtle.

Avoid legends, labels of the data are better or titles with color.

#### White space

Use white space to separate elements of the graph and give the reader room to understand the graph.

### Typography

#### Fonts

#### Hierarchy

This gives the reader a hierarchy of information.

### Color

What colors look good together?


::: {.cell}

```{.r .cell-code}
# Load required libraries
library(ggplot2)

# Create a data frame of angles and radii
angles <- seq(0, 360, by = 0.1)
radii <- seq(0.1, 1, by = 0.1)  # Vary the starting point to avoid a point at the center
df <- expand.grid(angle = angles, radius = radii)

# Create ggplot of colored points in polar coordinates
p <- ggplot(df, aes(x = angle, y = radius, color = angle, alpha = radius)) +
  geom_point(size = 8) +
  scale_color_gradientn(colors = rainbow(360)) +
  scale_alpha_continuous(range = c(1, 0.1)) +
  coord_polar(theta = "x") +
  theme_void() +
  theme(axis.text = element_blank(),
        axis.title = element_blank(),
        axis.ticks = element_blank(),
        legend.position = "none")
  

#### Alternative

# Create a data frame of angles from 0 to 360
angles <- seq(0, 360, by = 0.2)
df <- data.frame(angle = angles)

# Create ggplot of colored points in polar coordinates
p <- ggplot(df, aes(x = angle, y = 1, color = angle)) +
  geom_point(size = 10) +
  scale_color_gradientn(colors = rainbow(360)) +
  coord_polar(theta = "x") +
  theme_void() +
  theme(axis.text = element_blank(),
        axis.title = element_blank(),
        axis.ticks = element_blank(),
        legend.position = "none")
```
:::


The color wheel can be used to find

-   Complementary colors that will give high contrast
-   Monochromatic will give harmonious\
-   Analogous are choosen from the same side on the color wheele colors to avoid contrast but still enable showing differences
-   Triadic colors to give more

 https://www.canva.com/colors/color-wheel/ for more on this 

#### Describing colors, Hue, Saturation and Lightness

#### Background colors

Colors can help reduce "hardness" by avoiding a white background.-->



</section>
</section>


</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Preface</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./version-control.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Version control and collaborative scientific coding</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>